package com.appirio;

import java.io.BufferedOutputStream;
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.net.MalformedURLException;
import java.net.URL;
import java.net.URLConnection;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Map;

import org.apache.commons.lang3.StringEscapeUtils;
import org.codehaus.jackson.map.ObjectMapper;

import com.appirio.report.ExcelReporter;
import com.appirio.report.PdfReporter;
import com.appirio.report.Reporter;


/**
 * @author jesus
 *
 * This class is calls the pdf combiner and reporter and can be used as a Worker process
 * that listens for messages coming from CLOUDAMQP.
 */
public class WorkerProcess {
	//private final static String QUEUE_NAME = "pdfcombiner";

	public static void main(String[] argv) throws Exception {
		try {  
			// get a unique id
			String uniqueId = String.valueOf(Calendar.getInstance().getTimeInMillis());
			
			String sessionId = "00DW00000073REe!ASAAQPzRxBNRuHgWj.7TLjshlKcuInvXqZAh2RWCbXB9Qs3W62Xx3ZE9HXtXvxoywo0vgfItloMHV.bPin.yE4zmWK5SZbeE";

			String jsonString ="";
			//location buy type
			//pdf
			jsonString="{\"versionNumber\":\"V.006\",\"title\":\"\",\"subTitle\":\"\",\"showTotalProgramSummary\":true,\"showTimeAndDateStamp\":true,\"showTableOfContents\":true,\"showPageNumbering\":true,\"showIndividualMarketSummary\":true,\"showIndividualFlightSummary\":true,\"showCoverPage\":true,\"shippingInstructionsUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+Address1__c%2C+Address2__c%2C+Addressee__c%2C+Attention__c%2C+City__c%2C+Country__c%2C+Division__r.Name%2C+Notes__c%2C+Phone__c%2C+Receiving_Time__c%2C+Sales_Plan__c%2C+State__c%2C+Zip_Code__c+FROM+Plan_Shipping_Instruction__c+WHERE+Sales_Plan__c+%3D+%27a0u50000000ZrRlAAK%27\",\"sessionId\":\"00D5000000071dC!ASAAQI5oo2seEvuMYyVDDAvH3hodwA.laOFQfIGyNI1V9LNxPk5PDRqycAmTta_AGlyjER.nBLBAleWuLY0yTyJfbd4SuR1E\",\"packageSummaryUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+Id%2C+Package_Name__c%2C+Name%2C+Total_Price__c+FROM+Sales_Plan_Package__c+WHERE+Campaign_Sales_Plan__c+%3D+%27a0u50000000ZrRlAAK%27\",\"outputFileName\":\"a0u50000000ZrRlAAK Anjali-LocationDigital-T-187101\",\"marketName\":null,\"marketContactInformation\":null,\"mapPanelOrderPrefUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+Sort_Sequence__c%2C+Flight__c%2C+Panel__c+FROM+Map_Panel_Order_Pref__c+WHERE+Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a0u50000000ZrRlAAK%27+ORDER+BY+Flight__c%2C+Sort_Sequence__c\",\"insertContentVersionUrl\":\"https://na3.salesforce.com/services/data/v27.0/sobjects/ContentVersion\",\"exportToXls\":false,\"exportToPdf\":true,\"excludeFlightLines\":false,\"email\":null,\"disclaimerUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT%20Disclaimer__c%2C%20Notes__c%2C%20Sequence__c%2C%20Name%2C%20isShippingInstruction__c%2C%20Media_Types__c%2C%20Division__c%20FROM%20Proposal_Disclaimer__c%20ORDER%20BY%20Sequence__c\",\"dateTimeStamp\":\"09/27/2013 08:00 AM EDT\",\"contents\":[{\"title\":\"\",\"showTitle\":null,\"showAppendixEntry\":true,\"salesforceUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Unit_Size__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c+FROM+Child_Flight_Lines__r%29%2C++MapLocation_Number__c%2CMedia_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CNetwork_Name__c%2CLocation_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotal_Imps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CUnit_Size__c%2CIllumination_yn__c%2CHours_of_Operation__c%2CComments__c%2CNetwork_Description__c%2CTiming__c%2CWeeklyMarketImps__c%2CWeeklyInMarketImps__c%2CMedia_Product__c%2CRide_Order__c%2CX4_Wk_Base_Rate__c%2CX4_Wk_Floor__c%2CNetwork_Notes__c%2CAverage_Daily_Spots__c%2CFacing__c%2CIn_Mkt_Perc_Comp__c%2CPackage_Flight__r.Id%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Target_Population__c%2CPackage_Flight__r.Type__c%2C+Id%2C+Package_Flight__r.Media_Category__c++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a0u50000000ZrRlAAK%27+ORDER+BY+Package_Flight__r.Name+\",\"pathOnClient\":\"filea0u50000000ZrRlAAK.xml\",\"fieldTypesPipeDelimited\":[\"String&#124;String&#124;Double&#124;String&#124;String&#124;String&#124;String&#124;String&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Currency&#124;Currency&#124;Currency&#124;Currency&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;Double&#124;Double&#124;String&#124;String&#124;Currency&#124;Currency&#124;String&#124;String&#124;String&#124;Double&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;Double&#124;String\"],\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":[\"MapLocation_Number__c&#124;Media_Category__c&#124;Number_of_Panels__c&#124;Panel_Id_Label__c&#124;TAB_Id__c&#124;Network_Name__c&#124;Location_Description__c&#124;Face_Direction__c&#124;Weekly_Total_18_Imps__c&#124;In_Mkt_Imps__c&#124;Total_Imps__c&#124;In_Mkt_TRP__c&#124;PlanTRP__c&#124;Plan_Imps_Reach_Perc__c&#124;Plan_Imps_Avg_Frequency__c&#124;X4_Wk_Proposed_Price__c&#124;Total_Price_0d__c&#124;TotalInMarketCPM_0d__c&#124;CPP_0d__c&#124;Unit_Size__c&#124;Illumination_yn__c&#124;Hours_of_Operation__c&#124;Comments__c&#124;Network_Description__c&#124;Timing__c&#124;WeeklyMarketImps__c&#124;WeeklyInMarketImps__c&#124;Media_Product__c&#124;Ride_Order__c&#124;X4_Wk_Base_Rate__c&#124;X4_Wk_Floor__c&#124;Network_Notes__c&#124;Average_Daily_Spots__c&#124;Facing__c&#124;In_Mkt_Perc_Comp__c&#124;Package_Flight__r/Division__c&#124;Package_Flight__r/Package_Name__c&#124;Package_Flight__r/Name&#124;Package_Flight__r/Market_Name__c&#124;Package_Flight__r/Campaign_Start_Date__c&#124;Package_Flight__r/Campaign_End_Date__c&#124;Package_Flight__r/Duration_And_Type__c&#124;Package_Flight__r/Target__c&#124;Package_Flight__r/Flight_Comments__c&#124;Package_Flight__r/Package_Comments__c&#124;Package_Flight__r/Market_Type__c&#124;Package_Flight__r/Target_Population__c&#124;Package_Flight__r/Type__c\"],\"fieldLabelsPipeDelimited\":[\"Map Location #&#124;Media Type&#124;# of Panels&#124;Panel ID&#124;TAB ID&#124;Network Name&#124;Description&#124;Face Dir&#124;Weekly Total 18+ Imps&#124;Target In-Market Imps&#124;Target Total Imps&#124;Weekly TRP&#124;Plan TRP&#124;Reach %&#124;Freq&#124;4-Wk Proposed Price&#124;Total Price&#124;CPM&#124;CPP&#124;Unit Size* (HxW)&#124;Illum (Y/N)&#124;Hours of Operation&#124;Line Item Comments&#124;Network Description&#124;Timing&#124;Weekly Total Imps&#124;Weekly In-Market Imps&#124;Media Product&#124;Ride Order&#124;4-Wk Base Rate&#124;4-Wk Floor&#124;Network Notes&#124;Average Daily Spots&#124;Face Side&#124;In Mkt Perc Comp&#124;Division&#124;Package Name&#124;Flight Name&#124;Market Name&#124;Start Date&#124;End Date&#124;Duration&#124;Target&#124;Flight Comments&#124;Package Comments&#124;Market Type&#124;Target Population&#124;Buy Type\"],\"description\":\"\",\"buyType\":\"Location\"}],\"contentDocumentId\":\"05850000000PQmV\",\"clientContactInformation\":\"Appirio Dev\",\"clientCompanyName\":\"Clear Channel Outdoor\",\"attachmentsUrl\":\"https://na3.salesforce.com/services/data/v27.0/sobjects/Attachment/\",\"appendixes\":[],\"agencyName\":null,\"agencyContactInformation\":null}";
			//xls
			jsonString="{\"versionNumber\":\"V.006\",\"title\":\"\",\"subTitle\":\"\",\"showTotalProgramSummary\":true,\"showTimeAndDateStamp\":true,\"showTableOfContents\":true,\"showPageNumbering\":true,\"showIndividualMarketSummary\":true,\"showIndividualFlightSummary\":true,\"showCoverPage\":true,\"shippingInstructionsUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+Address1__c%2C+Address2__c%2C+Addressee__c%2C+Attention__c%2C+City__c%2C+Country__c%2C+Division__r.Name%2C+Notes__c%2C+Phone__c%2C+Receiving_Time__c%2C+Sales_Plan__c%2C+State__c%2C+Zip_Code__c+FROM+Plan_Shipping_Instruction__c+WHERE+Sales_Plan__c+%3D+%27a0u50000000ZrRlAAK%27\",\"sessionId\":\"00D5000000071dC!ASAAQI5oo2seEvuMYyVDDAvH3hodwA.laOFQfIGyNI1V9LNxPk5PDRqycAmTta_AGlyjER.nBLBAleWuLY0yTyJfbd4SuR1E\",\"packageSummaryUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+Id%2C+Package_Name__c%2C+Name%2C+Total_Price__c+FROM+Sales_Plan_Package__c+WHERE+Campaign_Sales_Plan__c+%3D+%27a0u50000000ZrRlAAK%27\",\"outputFileName\":\"a0u50000000ZrRlAAK Anjali-LocationDigital-T-187101\",\"marketName\":null,\"marketContactInformation\":null,\"mapPanelOrderPrefUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+Sort_Sequence__c%2C+Flight__c%2C+Panel__c+FROM+Map_Panel_Order_Pref__c+WHERE+Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a0u50000000ZrRlAAK%27+ORDER+BY+Flight__c%2C+Sort_Sequence__c\",\"insertContentVersionUrl\":\"https://na3.salesforce.com/services/data/v27.0/sobjects/ContentVersion\",\"exportToXls\":true,\"exportToPdf\":false,\"excludeFlightLines\":false,\"email\":null,\"disclaimerUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT%20Disclaimer__c%2C%20Notes__c%2C%20Sequence__c%2C%20Name%2C%20isShippingInstruction__c%2C%20Media_Types__c%2C%20Division__c%20FROM%20Proposal_Disclaimer__c%20ORDER%20BY%20Sequence__c\",\"dateTimeStamp\":null,\"contents\":[{\"title\":\"\",\"showTitle\":null,\"showAppendixEntry\":true,\"salesforceUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Unit_Size__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c+FROM+Child_Flight_Lines__r%29%2C++X4_Wk_Base_Rate__c%2CX4_Wk_Floor__c%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2CMapLocation_Number__c%2CMedia_Category__c%2CPackage_Flight__r.Media_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CNetwork_Name__c%2CLocation_Description__c%2CNetwork_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotal_Imps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CUnit_Size__c%2CIllumination_yn__c%2CMax_of_Spots_per_Loop__c%2CHours_of_Operation__c%2CComments__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CPackage_Flight__r.Target_Population__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Type__c%2CFacing__c%2CNetwork_Notes__c%2CTiming__c%2CWeekly_Total_18_Imps_000__c%2CWeeklyMarketImps__c%2CWeekly_Total_Target_Imps_000__c%2CWeeklyInMarketImps__c%2CWeekly_In_Market_Target_Imps_000__c%2CTarget_In_Market_Imps_000__c%2CTarget_Total_Imps_000__c%2CIn_Mkt_Perc_Comp__c%2CX4_Wk_Avg_Rate_per_Panel__c%2CNet_Amount_Value__c%2CProduction__c%2CAdditional_Cost__c%2CTax_Amt__c%2CLocation_Longitude__c%2CLocation_Latitude__c%2CAverage_Daily_Spots__c%2CEmbellishments__c%2CIllumination__c%2CCurrent_Copy__c%2CCity__c%2CCounty__c%2CState__c%2CZip__c%2CMedia_Product__c%2CRide_Order__c%2CPackage_Flight__r.Target_Population__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Type__c%2CFacing__c%2CNetwork_Notes__c%2CTiming__c%2CWeekly_Total_18_Imps_000__c%2CWeeklyMarketImps__c%2CWeekly_Total_Target_Imps_000__c%2CWeeklyInMarketImps__c%2CWeekly_In_Market_Target_Imps_000__c%2CTarget_In_Market_Imps_000__c%2CTarget_Total_Imps_000__c%2CIn_Mkt_Perc_Comp__c%2CX4_Wk_Avg_Rate_per_Panel__c%2CNet_Amount_Value__c%2CProduction__c%2CAdditional_Cost__c%2CTax_Amt__c%2CLocation_Longitude__c%2CLocation_Latitude__c%2CAverage_Daily_Spots__c%2CEmbellishments__c%2CIllumination__c%2CCurrent_Copy__c%2CCity__c%2CCounty__c%2CState__c%2CZip__c%2CMedia_Product__c%2CRide_Order__c%2C+Id%2C+Package_Flight__r.Id++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a0u50000000ZrRlAAK%27+ORDER+BY+Package_Flight__r.Name+\",\"pathOnClient\":\"filea0u50000000ZrRlAAK.xml\",\"fieldTypesPipeDelimited\":[\"Currency&#124;Currency&#124;Currency&#124;Currency&#124;&#124;&#124;&#124;&#124;&#124;&#124;&#124;&#124;String&#124;String&#124;&#124;Double&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Currency&#124;Currency&#124;Currency&#124;Currency&#124;String&#124;String&#124;String&#124;String&#124;String&#124;&#124;&#124;&#124;&#124;&#124;String&#124;String&#124;String&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Currency&#124;Currency&#124;Currency&#124;Currency&#124;Currency&#124;Double&#124;Double&#124;String&#124;String&#124;Double&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;&#124;&#124;&#124;String&#124;String&#124;String&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Currency&#124;Currency&#124;Currency&#124;Currency&#124;Currency&#124;Double&#124;Double&#124;String&#124;String&#124;Double&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String\"],\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":[\"X4_Wk_Base_Rate__c&#124;X4_Wk_Floor__c&#124;Package_Flight__r/Division__c&#124;Package_Flight__r/Package_Name__c&#124;Package_Flight__r/Name&#124;Package_Flight__r/Market_Name__c&#124;Package_Flight__r/Campaign_Start_Date__c&#124;Package_Flight__r/Campaign_End_Date__c&#124;Package_Flight__r/Duration_And_Type__c&#124;Package_Flight__r/Target__c&#124;MapLocation_Number__c&#124;Media_Category__c&#124;Package_Flight__r/Media_Category__c&#124;Number_of_Panels__c&#124;Panel_Id_Label__c&#124;TAB_Id__c&#124;Network_Name__c&#124;Location_Description__c&#124;Network_Description__c&#124;Face_Direction__c&#124;Weekly_Total_18_Imps__c&#124;In_Mkt_Imps__c&#124;Total_Imps__c&#124;In_Mkt_TRP__c&#124;PlanTRP__c&#124;Plan_Imps_Reach_Perc__c&#124;Plan_Imps_Avg_Frequency__c&#124;X4_Wk_Proposed_Price__c&#124;Total_Price_0d__c&#124;TotalInMarketCPM_0d__c&#124;CPP_0d__c&#124;Unit_Size__c&#124;Illumination_yn__c&#124;Max_of_Spots_per_Loop__c&#124;Hours_of_Operation__c&#124;Comments__c&#124;Package_Flight__r/Flight_Comments__c&#124;Package_Flight__r/Package_Comments__c&#124;Package_Flight__r/Target_Population__c&#124;Package_Flight__r/Market_Type__c&#124;Package_Flight__r/Type__c&#124;Facing__c&#124;Network_Notes__c&#124;Timing__c&#124;Weekly_Total_18_Imps_000__c&#124;WeeklyMarketImps__c&#124;Weekly_Total_Target_Imps_000__c&#124;WeeklyInMarketImps__c&#124;Weekly_In_Market_Target_Imps_000__c&#124;Target_In_Market_Imps_000__c&#124;Target_Total_Imps_000__c&#124;In_Mkt_Perc_Comp__c&#124;X4_Wk_Avg_Rate_per_Panel__c&#124;Net_Amount_Value__c&#124;Production__c&#124;Additional_Cost__c&#124;Tax_Amt__c&#124;Location_Longitude__c&#124;Location_Latitude__c&#124;Average_Daily_Spots__c&#124;Embellishments__c&#124;Illumination__c&#124;Current_Copy__c&#124;City__c&#124;County__c&#124;State__c&#124;Zip__c&#124;Media_Product__c&#124;Ride_Order__c&#124;Package_Flight__r/Target_Population__c&#124;Package_Flight__r/Market_Type__c&#124;Package_Flight__r/Type__c&#124;Facing__c&#124;Network_Notes__c&#124;Timing__c&#124;Weekly_Total_18_Imps_000__c&#124;WeeklyMarketImps__c&#124;Weekly_Total_Target_Imps_000__c&#124;WeeklyInMarketImps__c&#124;Weekly_In_Market_Target_Imps_000__c&#124;Target_In_Market_Imps_000__c&#124;Target_Total_Imps_000__c&#124;In_Mkt_Perc_Comp__c&#124;X4_Wk_Avg_Rate_per_Panel__c&#124;Net_Amount_Value__c&#124;Production__c&#124;Additional_Cost__c&#124;Tax_Amt__c&#124;Location_Longitude__c&#124;Location_Latitude__c&#124;Average_Daily_Spots__c&#124;Embellishments__c&#124;Illumination__c&#124;Current_Copy__c&#124;City__c&#124;County__c&#124;State__c&#124;Zip__c&#124;Media_Product__c&#124;Ride_Order__c\"],\"fieldLabelsPipeDelimited\":[\"4-Wk Base Rate&#124;4-Wk Floor&#124;4-Wk Base Rate&#124;4-Wk Floor&#124;Division&#124;Package Name&#124;Flight Name&#124;Market Name&#124;Start Date&#124;End Date&#124;Duration&#124;Target&#124;Map Location #&#124;Media Type&#124;Media Category&#124;# of Panels&#124;Panel ID&#124;TAB ID&#124;Network Name&#124;Description&#124;Network Description&#124;Face Dir&#124;Weekly Total 18+ Imps&#124;Target In-Market Imps&#124;Target Total Imps&#124;Weekly TRP&#124;Plan TRP&#124;Reach %&#124;Freq&#124;4-Wk Proposed Price&#124;Total Price&#124;CPM&#124;CPP&#124;Unit Size* (HxW)&#124;Illum (Y/N)&#124;Max # of Spots per Loop&#124;Hours of Operation&#124;Line Item Comments&#124;Flight Comments&#124;Package Comments&#124;Target Population&#124;Market Type&#124;Buy Type&#124;Face Side&#124;Network Notes&#124;Timing&#124;Weekly Total 18+ Imps (000)&#124;Weekly Total Imps&#124;Weekly Total Target Imps (000)&#124;Weekly In-Market Imps&#124;Weekly In-Market Target Imps (000)&#124;Target In-Market Imps (000)&#124;Target Total Imps (000)&#124;In Mkt Perc Comp&#124;4-Wk Avg Rate per Panel&#124;Sub Total&#124;Production&#124;Additional Cost&#124;Tax (Amt)&#124;Longitude&#124;Latitude&#124;Average Daily Spots&#124;Embellishment Y/N&#124;Hours of Illumination&#124;Current Copy&#124;City&#124;County&#124;State&#124;Zip&#124;Media Product&#124;Ride Order&#124;Target Population&#124;Market Type&#124;Buy Type&#124;Face Side&#124;Network Notes&#124;Timing&#124;Weekly Total 18+ Imps (000)&#124;Weekly Total Imps&#124;Weekly Total Target Imps (000)&#124;Weekly In-Market Imps&#124;Weekly In-Market Target Imps (000)&#124;Target In-Market Imps (000)&#124;Target Total Imps (000)&#124;In Mkt Perc Comp&#124;4-Wk Avg Rate per Panel&#124;Sub Total&#124;Production&#124;Additional Cost&#124;Tax (Amt)&#124;Longitude&#124;Latitude&#124;Average Daily Spots&#124;Embellishment Y/N&#124;Hours of Illumination&#124;Current Copy&#124;City&#124;County&#124;State&#124;Zip&#124;Media Product&#124;Ride Order\"],\"description\":\"\",\"buyType\":\"Location\"}],\"contentDocumentId\":\"05850000000PQmV\",\"clientContactInformation\":\"Appirio Dev\",\"clientCompanyName\":\"Clear Channel Outdoor\",\"attachmentsUrl\":\"https://na3.salesforce.com/services/data/v27.0/sobjects/Attachment/\",\"appendixes\":[],\"agencyName\":null,\"agencyContactInformation\":null}";

			//network buy type
			//pdf
			jsonString="{\"versionNumber\":\"V.003\",\"title\":\"\",\"subTitle\":\"\",\"showTotalProgramSummary\":true,\"showTimeAndDateStamp\":true,\"showTableOfContents\":true,\"showPageNumbering\":true,\"showIndividualMarketSummary\":true,\"showIndividualFlightSummary\":true,\"showCoverPage\":true,\"shippingInstructionsUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+Address1__c%2C+Address2__c%2C+Addressee__c%2C+Attention__c%2C+City__c%2C+Country__c%2C+Division__r.Name%2C+Notes__c%2C+Phone__c%2C+Receiving_Time__c%2C+Sales_Plan__c%2C+State__c%2C+Zip_Code__c+FROM+Plan_Shipping_Instruction__c+WHERE+Sales_Plan__c+%3D+%27a0u50000000ZrRqAAK%27\",\"sessionId\":\"00D5000000071dC!ASAAQI5oo2seEvuMYyVDDAvH3hodwA.laOFQfIGyNI1V9LNxPk5PDRqycAmTta_AGlyjER.nBLBAleWuLY0yTyJfbd4SuR1E\",\"packageSummaryUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+Id%2C+Package_Name__c%2C+Name%2C+Total_Price__c+FROM+Sales_Plan_Package__c+WHERE+Campaign_Sales_Plan__c+%3D+%27a0u50000000ZrRqAAK%27\",\"outputFileName\":\"a0u50000000ZrRqAAK Anjali-Network-Digital-T-187101\",\"marketName\":null,\"marketContactInformation\":null,\"mapPanelOrderPrefUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+Sort_Sequence__c%2C+Flight__c%2C+Panel__c+FROM+Map_Panel_Order_Pref__c+WHERE+Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a0u50000000ZrRqAAK%27+ORDER+BY+Flight__c%2C+Sort_Sequence__c\",\"insertContentVersionUrl\":\"https://na3.salesforce.com/services/data/v27.0/sobjects/ContentVersion\",\"exportToXls\":false,\"exportToPdf\":true,\"excludeFlightLines\":false,\"email\":null,\"disclaimerUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT%20Disclaimer__c%2C%20Notes__c%2C%20Sequence__c%2C%20Name%2C%20isShippingInstruction__c%2C%20Media_Types__c%2C%20Division__c%20FROM%20Proposal_Disclaimer__c%20ORDER%20BY%20Sequence__c\",\"dateTimeStamp\":\"09/27/2013 08:01 AM EDT\",\"contents\":[{\"title\":\"\",\"showTitle\":null,\"showAppendixEntry\":true,\"salesforceUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Unit_Size__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c+FROM+Child_Flight_Lines__r%29%2C++MapLocation_Number__c%2CMedia_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CNetwork_Name__c%2CLocation_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotal_Imps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CUnit_Size__c%2CIllumination_yn__c%2CHours_of_Operation__c%2CComments__c%2CNetwork_Description__c%2CTiming__c%2CWeeklyMarketImps__c%2CWeeklyInMarketImps__c%2CMedia_Product__c%2CRide_Order__c%2CX4_Wk_Base_Rate__c%2CX4_Wk_Floor__c%2CNetwork_Notes__c%2CAverage_Daily_Spots__c%2CFacing__c%2CIn_Mkt_Perc_Comp__c%2CPackage_Flight__r.Id%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Target_Population__c%2CPackage_Flight__r.Type__c%2C+Id%2C+Package_Flight__r.Media_Category__c++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a0u50000000ZrRqAAK%27+ORDER+BY+Package_Flight__r.Name+\",\"pathOnClient\":\"filea0u50000000ZrRqAAK.xml\",\"fieldTypesPipeDelimited\":[\"String&#124;String&#124;Double&#124;String&#124;String&#124;String&#124;String&#124;String&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Currency&#124;Currency&#124;Currency&#124;Currency&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;Double&#124;Double&#124;String&#124;String&#124;Currency&#124;Currency&#124;String&#124;String&#124;String&#124;Double&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;Double&#124;String\"],\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":[\"MapLocation_Number__c&#124;Media_Category__c&#124;Number_of_Panels__c&#124;Panel_Id_Label__c&#124;TAB_Id__c&#124;Network_Name__c&#124;Location_Description__c&#124;Face_Direction__c&#124;Weekly_Total_18_Imps__c&#124;In_Mkt_Imps__c&#124;Total_Imps__c&#124;In_Mkt_TRP__c&#124;PlanTRP__c&#124;Plan_Imps_Reach_Perc__c&#124;Plan_Imps_Avg_Frequency__c&#124;X4_Wk_Proposed_Price__c&#124;Total_Price_0d__c&#124;TotalInMarketCPM_0d__c&#124;CPP_0d__c&#124;Unit_Size__c&#124;Illumination_yn__c&#124;Hours_of_Operation__c&#124;Comments__c&#124;Network_Description__c&#124;Timing__c&#124;WeeklyMarketImps__c&#124;WeeklyInMarketImps__c&#124;Media_Product__c&#124;Ride_Order__c&#124;X4_Wk_Base_Rate__c&#124;X4_Wk_Floor__c&#124;Network_Notes__c&#124;Average_Daily_Spots__c&#124;Facing__c&#124;In_Mkt_Perc_Comp__c&#124;Package_Flight__r/Division__c&#124;Package_Flight__r/Package_Name__c&#124;Package_Flight__r/Name&#124;Package_Flight__r/Market_Name__c&#124;Package_Flight__r/Campaign_Start_Date__c&#124;Package_Flight__r/Campaign_End_Date__c&#124;Package_Flight__r/Duration_And_Type__c&#124;Package_Flight__r/Target__c&#124;Package_Flight__r/Flight_Comments__c&#124;Package_Flight__r/Package_Comments__c&#124;Package_Flight__r/Market_Type__c&#124;Package_Flight__r/Target_Population__c&#124;Package_Flight__r/Type__c\"],\"fieldLabelsPipeDelimited\":[\"Map Location #&#124;Media Type&#124;# of Panels&#124;Panel ID&#124;TAB ID&#124;Network Name&#124;Description&#124;Face Dir&#124;Weekly Total 18+ Imps&#124;Target In-Market Imps&#124;Target Total Imps&#124;Weekly TRP&#124;Plan TRP&#124;Reach %&#124;Freq&#124;4-Wk Proposed Price&#124;Total Price&#124;CPM&#124;CPP&#124;Unit Size* (HxW)&#124;Illum (Y/N)&#124;Hours of Operation&#124;Line Item Comments&#124;Network Description&#124;Timing&#124;Weekly Total Imps&#124;Weekly In-Market Imps&#124;Media Product&#124;Ride Order&#124;4-Wk Base Rate&#124;4-Wk Floor&#124;Network Notes&#124;Average Daily Spots&#124;Face Side&#124;In Mkt Perc Comp&#124;Division&#124;Package Name&#124;Flight Name&#124;Market Name&#124;Start Date&#124;End Date&#124;Duration&#124;Target&#124;Flight Comments&#124;Package Comments&#124;Market Type&#124;Target Population&#124;Buy Type\"],\"description\":\"\",\"buyType\":\"Network/Custom\"}],\"contentDocumentId\":\"05850000000PQmV\",\"clientContactInformation\":\"Appirio Dev\",\"clientCompanyName\":\"Clear Channel Outdoor\",\"attachmentsUrl\":\"https://na3.salesforce.com/services/data/v27.0/sobjects/Attachment/\",\"appendixes\":[],\"agencyName\":null,\"agencyContactInformation\":null}";
			//xls
			jsonString="{\"versionNumber\":\"V.003\",\"title\":\"\",\"subTitle\":\"\",\"showTotalProgramSummary\":true,\"showTimeAndDateStamp\":true,\"showTableOfContents\":true,\"showPageNumbering\":true,\"showIndividualMarketSummary\":true,\"showIndividualFlightSummary\":true,\"showCoverPage\":true,\"shippingInstructionsUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+Address1__c%2C+Address2__c%2C+Addressee__c%2C+Attention__c%2C+City__c%2C+Country__c%2C+Division__r.Name%2C+Notes__c%2C+Phone__c%2C+Receiving_Time__c%2C+Sales_Plan__c%2C+State__c%2C+Zip_Code__c+FROM+Plan_Shipping_Instruction__c+WHERE+Sales_Plan__c+%3D+%27a0u50000000ZrRqAAK%27\",\"sessionId\":\"00D5000000071dC!ASAAQI5oo2seEvuMYyVDDAvH3hodwA.laOFQfIGyNI1V9LNxPk5PDRqycAmTta_AGlyjER.nBLBAleWuLY0yTyJfbd4SuR1E\",\"packageSummaryUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+Id%2C+Package_Name__c%2C+Name%2C+Total_Price__c+FROM+Sales_Plan_Package__c+WHERE+Campaign_Sales_Plan__c+%3D+%27a0u50000000ZrRqAAK%27\",\"outputFileName\":\"a0u50000000ZrRqAAK Anjali-Network-Digital-T-187101\",\"marketName\":null,\"marketContactInformation\":null,\"mapPanelOrderPrefUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+Sort_Sequence__c%2C+Flight__c%2C+Panel__c+FROM+Map_Panel_Order_Pref__c+WHERE+Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a0u50000000ZrRqAAK%27+ORDER+BY+Flight__c%2C+Sort_Sequence__c\",\"insertContentVersionUrl\":\"https://na3.salesforce.com/services/data/v27.0/sobjects/ContentVersion\",\"exportToXls\":true,\"exportToPdf\":false,\"excludeFlightLines\":false,\"email\":null,\"disclaimerUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT%20Disclaimer__c%2C%20Notes__c%2C%20Sequence__c%2C%20Name%2C%20isShippingInstruction__c%2C%20Media_Types__c%2C%20Division__c%20FROM%20Proposal_Disclaimer__c%20ORDER%20BY%20Sequence__c\",\"dateTimeStamp\":null,\"contents\":[{\"title\":\"\",\"showTitle\":null,\"showAppendixEntry\":true,\"salesforceUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Unit_Size__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c+FROM+Child_Flight_Lines__r%29%2C++X4_Wk_Base_Rate__c%2CX4_Wk_Floor__c%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2CMapLocation_Number__c%2CMedia_Category__c%2CPackage_Flight__r.Media_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CNetwork_Name__c%2CLocation_Description__c%2CNetwork_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotal_Imps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CUnit_Size__c%2CIllumination_yn__c%2CMax_of_Spots_per_Loop__c%2CHours_of_Operation__c%2CComments__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CPackage_Flight__r.Target_Population__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Type__c%2CFacing__c%2CNetwork_Notes__c%2CTiming__c%2CWeekly_Total_18_Imps_000__c%2CWeeklyMarketImps__c%2CWeekly_Total_Target_Imps_000__c%2CWeeklyInMarketImps__c%2CWeekly_In_Market_Target_Imps_000__c%2CTarget_In_Market_Imps_000__c%2CTarget_Total_Imps_000__c%2CIn_Mkt_Perc_Comp__c%2CX4_Wk_Avg_Rate_per_Panel__c%2CNet_Amount_Value__c%2CProduction__c%2CAdditional_Cost__c%2CTax_Amt__c%2CLocation_Longitude__c%2CLocation_Latitude__c%2CAverage_Daily_Spots__c%2CEmbellishments__c%2CIllumination__c%2CCurrent_Copy__c%2CCity__c%2CCounty__c%2CState__c%2CZip__c%2CMedia_Product__c%2CRide_Order__c%2C+Id%2C+Package_Flight__r.Id++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a0u50000000ZrRqAAK%27+ORDER+BY+Package_Flight__r.Name+\",\"pathOnClient\":\"filea0u50000000ZrRqAAK.xml\",\"fieldTypesPipeDelimited\":[\"Currency&#124;Currency&#124;&#124;&#124;&#124;&#124;&#124;&#124;&#124;&#124;String&#124;String&#124;&#124;Double&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Currency&#124;Currency&#124;Currency&#124;Currency&#124;String&#124;String&#124;String&#124;String&#124;String&#124;&#124;&#124;&#124;&#124;&#124;String&#124;String&#124;String&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Currency&#124;Currency&#124;Currency&#124;Currency&#124;Currency&#124;Double&#124;Double&#124;String&#124;String&#124;Double&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String\"],\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":[\"X4_Wk_Base_Rate__c&#124;X4_Wk_Floor__c&#124;Package_Flight__r/Division__c&#124;Package_Flight__r/Package_Name__c&#124;Package_Flight__r/Name&#124;Package_Flight__r/Market_Name__c&#124;Package_Flight__r/Campaign_Start_Date__c&#124;Package_Flight__r/Campaign_End_Date__c&#124;Package_Flight__r/Duration_And_Type__c&#124;Package_Flight__r/Target__c&#124;MapLocation_Number__c&#124;Media_Category__c&#124;Package_Flight__r/Media_Category__c&#124;Number_of_Panels__c&#124;Panel_Id_Label__c&#124;TAB_Id__c&#124;Network_Name__c&#124;Location_Description__c&#124;Network_Description__c&#124;Face_Direction__c&#124;Weekly_Total_18_Imps__c&#124;In_Mkt_Imps__c&#124;Total_Imps__c&#124;In_Mkt_TRP__c&#124;PlanTRP__c&#124;Plan_Imps_Reach_Perc__c&#124;Plan_Imps_Avg_Frequency__c&#124;X4_Wk_Proposed_Price__c&#124;Total_Price_0d__c&#124;TotalInMarketCPM_0d__c&#124;CPP_0d__c&#124;Unit_Size__c&#124;Illumination_yn__c&#124;Max_of_Spots_per_Loop__c&#124;Hours_of_Operation__c&#124;Comments__c&#124;Package_Flight__r/Flight_Comments__c&#124;Package_Flight__r/Package_Comments__c&#124;Package_Flight__r/Target_Population__c&#124;Package_Flight__r/Market_Type__c&#124;Package_Flight__r/Type__c&#124;Facing__c&#124;Network_Notes__c&#124;Timing__c&#124;Weekly_Total_18_Imps_000__c&#124;WeeklyMarketImps__c&#124;Weekly_Total_Target_Imps_000__c&#124;WeeklyInMarketImps__c&#124;Weekly_In_Market_Target_Imps_000__c&#124;Target_In_Market_Imps_000__c&#124;Target_Total_Imps_000__c&#124;In_Mkt_Perc_Comp__c&#124;X4_Wk_Avg_Rate_per_Panel__c&#124;Net_Amount_Value__c&#124;Production__c&#124;Additional_Cost__c&#124;Tax_Amt__c&#124;Location_Longitude__c&#124;Location_Latitude__c&#124;Average_Daily_Spots__c&#124;Embellishments__c&#124;Illumination__c&#124;Current_Copy__c&#124;City__c&#124;County__c&#124;State__c&#124;Zip__c&#124;Media_Product__c&#124;Ride_Order__c\"],\"fieldLabelsPipeDelimited\":[\"4-Wk Base Rate&#124;4-Wk Floor&#124;Division&#124;Package Name&#124;Flight Name&#124;Market Name&#124;Start Date&#124;End Date&#124;Duration&#124;Target&#124;Map Location #&#124;Media Type&#124;Media Category&#124;# of Panels&#124;Panel ID&#124;TAB ID&#124;Network Name&#124;Description&#124;Network Description&#124;Face Dir&#124;Weekly Total 18+ Imps&#124;Target In-Market Imps&#124;Target Total Imps&#124;Weekly TRP&#124;Plan TRP&#124;Reach %&#124;Freq&#124;4-Wk Proposed Price&#124;Total Price&#124;CPM&#124;CPP&#124;Unit Size* (HxW)&#124;Illum (Y/N)&#124;Max # of Spots per Loop&#124;Hours of Operation&#124;Line Item Comments&#124;Flight Comments&#124;Package Comments&#124;Target Population&#124;Market Type&#124;Buy Type&#124;Face Side&#124;Network Notes&#124;Timing&#124;Weekly Total 18+ Imps (000)&#124;Weekly Total Imps&#124;Weekly Total Target Imps (000)&#124;Weekly In-Market Imps&#124;Weekly In-Market Target Imps (000)&#124;Target In-Market Imps (000)&#124;Target Total Imps (000)&#124;In Mkt Perc Comp&#124;4-Wk Avg Rate per Panel&#124;Sub Total&#124;Production&#124;Additional Cost&#124;Tax (Amt)&#124;Longitude&#124;Latitude&#124;Average Daily Spots&#124;Embellishment Y/N&#124;Hours of Illumination&#124;Current Copy&#124;City&#124;County&#124;State&#124;Zip&#124;Media Product&#124;Ride Order\"],\"description\":\"\",\"buyType\":\"Network/Custom\"}],\"contentDocumentId\":\"05850000000PQmV\",\"clientContactInformation\":\"Appirio Dev\",\"clientCompanyName\":\"Clear Channel Outdoor\",\"attachmentsUrl\":\"https://na3.salesforce.com/services/data/v27.0/sobjects/Attachment/\",\"appendixes\":[],\"agencyName\":null,\"agencyContactInformation\":null}";

			//audience buy type
			//pdf
			jsonString = "{\"versionNumber\":\"V.003\",\"title\":\"\",\"subTitle\":\"\",\"showTotalProgramSummary\":true,\"showTimeAndDateStamp\":true,\"showTableOfContents\":true,\"showPageNumbering\":true,\"showIndividualMarketSummary\":true,\"showIndividualFlightSummary\":true,\"showCoverPage\":true,\"shippingInstructionsUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+Address1__c%2C+Address2__c%2C+Addressee__c%2C+Attention__c%2C+City__c%2C+Country__c%2C+Division__r.Name%2C+Notes__c%2C+Phone__c%2C+Receiving_Time__c%2C+Sales_Plan__c%2C+State__c%2C+Zip_Code__c+FROM+Plan_Shipping_Instruction__c+WHERE+Sales_Plan__c+%3D+%27a0u50000000ZrfnAAC%27\",\"sessionId\":\"00D5000000071dC!ASAAQI5oo2seEvuMYyVDDAvH3hodwA.laOFQfIGyNI1V9LNxPk5PDRqycAmTta_AGlyjER.nBLBAleWuLY0yTyJfbd4SuR1E\",\"packageSummaryUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+Id%2C+Package_Name__c%2C+Name%2C+Total_Price__c+FROM+Sales_Plan_Package__c+WHERE+Campaign_Sales_Plan__c+%3D+%27a0u50000000ZrfnAAC%27\",\"outputFileName\":\"a0u50000000ZrfnAAC Anjali-Audience-9/25/2013\",\"marketName\":null,\"marketContactInformation\":null,\"mapPanelOrderPrefUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+Sort_Sequence__c%2C+Flight__c%2C+Panel__c+FROM+Map_Panel_Order_Pref__c+WHERE+Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a0u50000000ZrfnAAC%27+ORDER+BY+Flight__c%2C+Sort_Sequence__c\",\"insertContentVersionUrl\":\"https://na3.salesforce.com/services/data/v27.0/sobjects/ContentVersion\",\"exportToXls\":false,\"exportToPdf\":true,\"excludeFlightLines\":false,\"email\":null,\"disclaimerUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT%20Disclaimer__c%2C%20Notes__c%2C%20Sequence__c%2C%20Name%2C%20isShippingInstruction__c%2C%20Media_Types__c%2C%20Division__c%20FROM%20Proposal_Disclaimer__c%20ORDER%20BY%20Sequence__c\",\"dateTimeStamp\":\"09/27/2013 08:01 AM EDT\",\"contents\":[{\"title\":\"\",\"showTitle\":null,\"showAppendixEntry\":true,\"salesforceUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Unit_Size__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c+FROM+Child_Flight_Lines__r%29%2C++MapLocation_Number__c%2CMedia_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CNetwork_Name__c%2CLocation_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotal_Imps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CUnit_Size__c%2CIllumination_yn__c%2CHours_of_Operation__c%2CComments__c%2CNetwork_Description__c%2CTiming__c%2CWeeklyMarketImps__c%2CWeeklyInMarketImps__c%2CMedia_Product__c%2CRide_Order__c%2CX4_Wk_Base_Rate__c%2CX4_Wk_Floor__c%2CNetwork_Notes__c%2CAverage_Daily_Spots__c%2CFacing__c%2CIn_Mkt_Perc_Comp__c%2CPackage_Flight__r.Id%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Target_Population__c%2CPackage_Flight__r.Type__c%2C+Id%2C+Package_Flight__r.Media_Category__c++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a0u50000000ZrfnAAC%27+ORDER+BY+Package_Flight__r.Name+\",\"pathOnClient\":\"filea0u50000000ZrfnAAC.xml\",\"fieldTypesPipeDelimited\":[\"String&#124;String&#124;Double&#124;String&#124;String&#124;String&#124;String&#124;String&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Currency&#124;Currency&#124;Currency&#124;Currency&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;Double&#124;Double&#124;String&#124;String&#124;Currency&#124;Currency&#124;String&#124;String&#124;String&#124;Double&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;Double&#124;String\"],\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":[\"MapLocation_Number__c&#124;Media_Category__c&#124;Number_of_Panels__c&#124;Panel_Id_Label__c&#124;TAB_Id__c&#124;Network_Name__c&#124;Location_Description__c&#124;Face_Direction__c&#124;Weekly_Total_18_Imps__c&#124;In_Mkt_Imps__c&#124;Total_Imps__c&#124;In_Mkt_TRP__c&#124;PlanTRP__c&#124;Plan_Imps_Reach_Perc__c&#124;Plan_Imps_Avg_Frequency__c&#124;X4_Wk_Proposed_Price__c&#124;Total_Price_0d__c&#124;TotalInMarketCPM_0d__c&#124;CPP_0d__c&#124;Unit_Size__c&#124;Illumination_yn__c&#124;Hours_of_Operation__c&#124;Comments__c&#124;Network_Description__c&#124;Timing__c&#124;WeeklyMarketImps__c&#124;WeeklyInMarketImps__c&#124;Media_Product__c&#124;Ride_Order__c&#124;X4_Wk_Base_Rate__c&#124;X4_Wk_Floor__c&#124;Network_Notes__c&#124;Average_Daily_Spots__c&#124;Facing__c&#124;In_Mkt_Perc_Comp__c&#124;Package_Flight__r/Division__c&#124;Package_Flight__r/Package_Name__c&#124;Package_Flight__r/Name&#124;Package_Flight__r/Market_Name__c&#124;Package_Flight__r/Campaign_Start_Date__c&#124;Package_Flight__r/Campaign_End_Date__c&#124;Package_Flight__r/Duration_And_Type__c&#124;Package_Flight__r/Target__c&#124;Package_Flight__r/Flight_Comments__c&#124;Package_Flight__r/Package_Comments__c&#124;Package_Flight__r/Market_Type__c&#124;Package_Flight__r/Target_Population__c&#124;Package_Flight__r/Type__c\"],\"fieldLabelsPipeDelimited\":[\"Map Location #&#124;Media Type&#124;# of Panels&#124;Panel ID&#124;TAB ID&#124;Network Name&#124;Description&#124;Face Dir&#124;Weekly Total 18+ Imps&#124;Target In-Market Imps&#124;Target Total Imps&#124;Weekly TRP&#124;Plan TRP&#124;Reach %&#124;Freq&#124;4-Wk Proposed Price&#124;Total Price&#124;CPM&#124;CPP&#124;Unit Size* (HxW)&#124;Illum (Y/N)&#124;Hours of Operation&#124;Line Item Comments&#124;Network Description&#124;Timing&#124;Weekly Total Imps&#124;Weekly In-Market Imps&#124;Media Product&#124;Ride Order&#124;4-Wk Base Rate&#124;4-Wk Floor&#124;Network Notes&#124;Average Daily Spots&#124;Face Side&#124;In Mkt Perc Comp&#124;Division&#124;Package Name&#124;Flight Name&#124;Market Name&#124;Start Date&#124;End Date&#124;Duration&#124;Target&#124;Flight Comments&#124;Package Comments&#124;Market Type&#124;Target Population&#124;Buy Type\"],\"description\":\"\",\"buyType\":\"Audience\"}],\"contentDocumentId\":\"05850000000PQmV\",\"clientContactInformation\":\"Appirio Dev\",\"clientCompanyName\":\"Clear Channel Outdoor\",\"attachmentsUrl\":\"https://na3.salesforce.com/services/data/v27.0/sobjects/Attachment/\",\"appendixes\":[],\"agencyName\":null,\"agencyContactInformation\":null}";
			//xls
			jsonString = "{\"versionNumber\":\"V.003\",\"title\":\"\",\"subTitle\":\"\",\"showTotalProgramSummary\":true,\"showTimeAndDateStamp\":true,\"showTableOfContents\":true,\"showPageNumbering\":true,\"showIndividualMarketSummary\":true,\"showIndividualFlightSummary\":true,\"showCoverPage\":true,\"shippingInstructionsUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+Address1__c%2C+Address2__c%2C+Addressee__c%2C+Attention__c%2C+City__c%2C+Country__c%2C+Division__r.Name%2C+Notes__c%2C+Phone__c%2C+Receiving_Time__c%2C+Sales_Plan__c%2C+State__c%2C+Zip_Code__c+FROM+Plan_Shipping_Instruction__c+WHERE+Sales_Plan__c+%3D+%27a0u50000000ZrfnAAC%27\",\"sessionId\":\"00D5000000071dC!ASAAQI5oo2seEvuMYyVDDAvH3hodwA.laOFQfIGyNI1V9LNxPk5PDRqycAmTta_AGlyjER.nBLBAleWuLY0yTyJfbd4SuR1E\",\"packageSummaryUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+Id%2C+Package_Name__c%2C+Name%2C+Total_Price__c+FROM+Sales_Plan_Package__c+WHERE+Campaign_Sales_Plan__c+%3D+%27a0u50000000ZrfnAAC%27\",\"outputFileName\":\"a0u50000000ZrfnAAC Anjali-Audience-9/25/2013\",\"marketName\":null,\"marketContactInformation\":null,\"mapPanelOrderPrefUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+Sort_Sequence__c%2C+Flight__c%2C+Panel__c+FROM+Map_Panel_Order_Pref__c+WHERE+Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a0u50000000ZrfnAAC%27+ORDER+BY+Flight__c%2C+Sort_Sequence__c\",\"insertContentVersionUrl\":\"https://na3.salesforce.com/services/data/v27.0/sobjects/ContentVersion\",\"exportToXls\":true,\"exportToPdf\":false,\"excludeFlightLines\":false,\"email\":null,\"disclaimerUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT%20Disclaimer__c%2C%20Notes__c%2C%20Sequence__c%2C%20Name%2C%20isShippingInstruction__c%2C%20Media_Types__c%2C%20Division__c%20FROM%20Proposal_Disclaimer__c%20ORDER%20BY%20Sequence__c\",\"dateTimeStamp\":null,\"contents\":[{\"title\":\"\",\"showTitle\":null,\"showAppendixEntry\":true,\"salesforceUrl\":\"https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Unit_Size__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c+FROM+Child_Flight_Lines__r%29%2C++X4_Wk_Base_Rate__c%2CX4_Wk_Floor__c%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2CMapLocation_Number__c%2CMedia_Category__c%2CPackage_Flight__r.Media_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CNetwork_Name__c%2CLocation_Description__c%2CNetwork_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotal_Imps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CUnit_Size__c%2CIllumination_yn__c%2CMax_of_Spots_per_Loop__c%2CHours_of_Operation__c%2CComments__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CPackage_Flight__r.Target_Population__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Type__c%2CFacing__c%2CNetwork_Notes__c%2CTiming__c%2CWeekly_Total_18_Imps_000__c%2CWeeklyMarketImps__c%2CWeekly_Total_Target_Imps_000__c%2CWeeklyInMarketImps__c%2CWeekly_In_Market_Target_Imps_000__c%2CTarget_In_Market_Imps_000__c%2CTarget_Total_Imps_000__c%2CIn_Mkt_Perc_Comp__c%2CX4_Wk_Avg_Rate_per_Panel__c%2CNet_Amount_Value__c%2CProduction__c%2CAdditional_Cost__c%2CTax_Amt__c%2CLocation_Longitude__c%2CLocation_Latitude__c%2CAverage_Daily_Spots__c%2CEmbellishments__c%2CIllumination__c%2CCurrent_Copy__c%2CCity__c%2CCounty__c%2CState__c%2CZip__c%2CMedia_Product__c%2CRide_Order__c%2C+Id%2C+Package_Flight__r.Id++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a0u50000000ZrfnAAC%27+ORDER+BY+Package_Flight__r.Name+\",\"pathOnClient\":\"filea0u50000000ZrfnAAC.xml\",\"fieldTypesPipeDelimited\":[\"Currency&#124;Currency&#124;&#124;&#124;&#124;&#124;&#124;&#124;&#124;&#124;String&#124;String&#124;&#124;Double&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Currency&#124;Currency&#124;Currency&#124;Currency&#124;String&#124;String&#124;String&#124;String&#124;String&#124;&#124;&#124;&#124;&#124;&#124;String&#124;String&#124;String&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Currency&#124;Currency&#124;Currency&#124;Currency&#124;Currency&#124;Double&#124;Double&#124;String&#124;String&#124;Double&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String\"],\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":[\"X4_Wk_Base_Rate__c&#124;X4_Wk_Floor__c&#124;Package_Flight__r/Division__c&#124;Package_Flight__r/Package_Name__c&#124;Package_Flight__r/Name&#124;Package_Flight__r/Market_Name__c&#124;Package_Flight__r/Campaign_Start_Date__c&#124;Package_Flight__r/Campaign_End_Date__c&#124;Package_Flight__r/Duration_And_Type__c&#124;Package_Flight__r/Target__c&#124;MapLocation_Number__c&#124;Media_Category__c&#124;Package_Flight__r/Media_Category__c&#124;Number_of_Panels__c&#124;Panel_Id_Label__c&#124;TAB_Id__c&#124;Network_Name__c&#124;Location_Description__c&#124;Network_Description__c&#124;Face_Direction__c&#124;Weekly_Total_18_Imps__c&#124;In_Mkt_Imps__c&#124;Total_Imps__c&#124;In_Mkt_TRP__c&#124;PlanTRP__c&#124;Plan_Imps_Reach_Perc__c&#124;Plan_Imps_Avg_Frequency__c&#124;X4_Wk_Proposed_Price__c&#124;Total_Price_0d__c&#124;TotalInMarketCPM_0d__c&#124;CPP_0d__c&#124;Unit_Size__c&#124;Illumination_yn__c&#124;Max_of_Spots_per_Loop__c&#124;Hours_of_Operation__c&#124;Comments__c&#124;Package_Flight__r/Flight_Comments__c&#124;Package_Flight__r/Package_Comments__c&#124;Package_Flight__r/Target_Population__c&#124;Package_Flight__r/Market_Type__c&#124;Package_Flight__r/Type__c&#124;Facing__c&#124;Network_Notes__c&#124;Timing__c&#124;Weekly_Total_18_Imps_000__c&#124;WeeklyMarketImps__c&#124;Weekly_Total_Target_Imps_000__c&#124;WeeklyInMarketImps__c&#124;Weekly_In_Market_Target_Imps_000__c&#124;Target_In_Market_Imps_000__c&#124;Target_Total_Imps_000__c&#124;In_Mkt_Perc_Comp__c&#124;X4_Wk_Avg_Rate_per_Panel__c&#124;Net_Amount_Value__c&#124;Production__c&#124;Additional_Cost__c&#124;Tax_Amt__c&#124;Location_Longitude__c&#124;Location_Latitude__c&#124;Average_Daily_Spots__c&#124;Embellishments__c&#124;Illumination__c&#124;Current_Copy__c&#124;City__c&#124;County__c&#124;State__c&#124;Zip__c&#124;Media_Product__c&#124;Ride_Order__c\"],\"fieldLabelsPipeDelimited\":[\"4-Wk Base Rate&#124;4-Wk Floor&#124;Division&#124;Package Name&#124;Flight Name&#124;Market Name&#124;Start Date&#124;End Date&#124;Duration&#124;Target&#124;Map Location #&#124;Media Type&#124;Media Category&#124;# of Panels&#124;Panel ID&#124;TAB ID&#124;Network Name&#124;Description&#124;Network Description&#124;Face Dir&#124;Weekly Total 18+ Imps&#124;Target In-Market Imps&#124;Target Total Imps&#124;Weekly TRP&#124;Plan TRP&#124;Reach %&#124;Freq&#124;4-Wk Proposed Price&#124;Total Price&#124;CPM&#124;CPP&#124;Unit Size* (HxW)&#124;Illum (Y/N)&#124;Max # of Spots per Loop&#124;Hours of Operation&#124;Line Item Comments&#124;Flight Comments&#124;Package Comments&#124;Target Population&#124;Market Type&#124;Buy Type&#124;Face Side&#124;Network Notes&#124;Timing&#124;Weekly Total 18+ Imps (000)&#124;Weekly Total Imps&#124;Weekly Total Target Imps (000)&#124;Weekly In-Market Imps&#124;Weekly In-Market Target Imps (000)&#124;Target In-Market Imps (000)&#124;Target Total Imps (000)&#124;In Mkt Perc Comp&#124;4-Wk Avg Rate per Panel&#124;Sub Total&#124;Production&#124;Additional Cost&#124;Tax (Amt)&#124;Longitude&#124;Latitude&#124;Average Daily Spots&#124;Embellishment Y/N&#124;Hours of Illumination&#124;Current Copy&#124;City&#124;County&#124;State&#124;Zip&#124;Media Product&#124;Ride Order\"],\"description\":\"\",\"buyType\":\"Audience\"}],\"contentDocumentId\":\"05850000000PQmV\",\"clientContactInformation\":\"Appirio Dev\",\"clientCompanyName\":\"Clear Channel Outdoor\",\"attachmentsUrl\":\"https://na3.salesforce.com/services/data/v27.0/sobjects/Attachment/\",\"appendixes\":[],\"agencyName\":null,\"agencyContactInformation\":null}";

			//multi buy type plan
			//pdf
			jsonString = "{\"versionNumber\":\"V.001\",\"title\":\"Multi Package Title\",\"subTitle\":\"Multi Package Subtitle\",\"showTotalProgramSummary\":true,\"showTimeAndDateStamp\":true,\"showTableOfContents\":true,\"showPageNumbering\":true,\"showIndividualMarketSummary\":true,\"showIndividualFlightSummary\":true,\"showCoverPage\":true,\"shippingInstructionsUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Name%2C+Address1__c%2C+Address2__c%2C+Addressee__c%2C+Attention__c%2C+City__c%2C+Country__c%2C+Division__r.Name%2C+Notes__c%2C+Phone__c%2C+Receiving_Time__c%2C+Sales_Plan__c%2C+State__c%2C+Zip_Code__c+FROM+Plan_Shipping_Instruction__c+WHERE+Sales_Plan__c+%3D+%27a13W0000001CFT0IAO%27\",\"sessionId\":\"00DW00000073REe!ASAAQEQXZu049gB3ngYBjYtxKlcX7z3SLhjHhVW5jNQCMfeJ39EBNu_7Czhb_3St9rT59joJzm0.V60zKrdfPunJvwdrMXs8\",\"packageSummaryUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Id%2C+Package_Name__c%2C+Name%2C+Total_Price__c+FROM+Sales_Plan_Package__c+WHERE+Campaign_Sales_Plan__c+%3D+%27a13W0000001CFT0IAO%27\",\"outputFileName\":\"a13W0000001CFT0IAO Multi Package Output\",\"marketName\":null,\"marketContactInformation\":null,\"mapPanelOrderPrefUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Sort_Sequence__c%2C+Flight__c%2C+Panel__c+FROM+Map_Panel_Order_Pref__c+WHERE+Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CFT0IAO%27+ORDER+BY+Flight__c%2C+Sort_Sequence__c\",\"insertContentVersionUrl\":\"https://cs13.salesforce.com/services/data/v27.0/sobjects/ContentVersion\",\"exportToXls\":false,\"exportToPdf\":true,\"excludeNetworkDetails\":true,\"excludeFlightLines\":false,\"email\":null,\"disclaimerUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT%20Disclaimer__c%2C%20Notes__c%2C%20Sequence__c%2C%20Name%2C%20isShippingInstruction__c%2C%20Media_Types__c%2C%20Division__c%20FROM%20Proposal_Disclaimer__c%20ORDER%20BY%20Sequence__c\",\"dateTimeStamp\":\"10/28/2013 00:47 AM PDT\",\"contents\":[{\"title\":\"Multi Package Title\",\"showTitle\":null,\"showAppendixEntry\":true,\"salesforceUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Unit_Size__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c+FROM+Child_Flight_Lines__r%29%2C++Package_Flight__r.Package_Market__r.Package__r.Package_Name__c%2C++Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Id%2C+Package_Flight__r.Package_Market__r.Weekly_Total_18_Imps__c%2C++Package_Flight__r.Package_Market__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.CPM__c%2C+Package_Flight__r.Package_Market__r.CPP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Id%2C+Package_Flight__r.Package_Market__r.Package__r.Weekly_Total_18_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Discount__c%2C+Package_Flight__r.Package_Market__r.Package__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPM__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPP__c%2C++MapLocation_Number__c%2CMedia_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CNetwork_Name__c%2CLocation_Description__c%2CNetwork_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotal_Imps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CDiscount__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CUnit_Size__c%2CIllumination_yn__c%2CHours_of_Operation__c%2CComments__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CFacing__c%2CNetwork_Notes__c%2CTiming__c%2CMedia_Product__c%2CRide_Order__c%2CAverage_Daily_Spots__c%2CProduction__c%2CAdditional_Cost__c%2CAdditional_Cost_Type__c%2CPackage_Flight__r.Id%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Target_Population__c%2CPackage_Flight__r.Type__c%2C+Id%2C+Package_Flight__r.Media_Category__c+%2C+OB_Summ_Num__c++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CFT0IAO%27+ORDER+BY+Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Package__r.Name%2C+Package_Flight__r.Name+\",\"pathOnClient\":\"filea13W0000001CFT0IAO.xml\",\"fieldTypesPipeDelimited\":[\"String&#124;String&#124;Double&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Currency&#124;Currency&#124;Double&#124;Currency&#124;String&#124;String&#124;String&#124;String&#124;&#124;&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;Currency&#124;Currency&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;Double&#124;String\"],\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":[\"MapLocation_Number__c&#124;Media_Category__c&#124;Number_of_Panels__c&#124;Panel_Id_Label__c&#124;TAB_Id__c&#124;Network_Name__c&#124;Location_Description__c&#124;Network_Description__c&#124;Face_Direction__c&#124;Weekly_Total_18_Imps__c&#124;In_Mkt_Imps__c&#124;Total_Imps__c&#124;In_Mkt_TRP__c&#124;PlanTRP__c&#124;Plan_Imps_Reach_Perc__c&#124;Plan_Imps_Avg_Frequency__c&#124;Discount__c&#124;X4_Wk_Proposed_Price__c&#124;Total_Price_0d__c&#124;TotalInMarketCPM_0d__c&#124;CPP_0d__c&#124;Unit_Size__c&#124;Illumination_yn__c&#124;Hours_of_Operation__c&#124;Comments__c&#124;Package_Flight__r/Flight_Comments__c&#124;Package_Flight__r/Package_Comments__c&#124;Facing__c&#124;Network_Notes__c&#124;Timing__c&#124;Media_Product__c&#124;Ride_Order__c&#124;Average_Daily_Spots__c&#124;Production__c&#124;Additional_Cost__c&#124;Package_Flight__r/Division__c&#124;Package_Flight__r/Market_Name__c&#124;Package_Flight__r/Package_Name__c&#124;Package_Flight__r/Name&#124;Package_Flight__r/Campaign_Start_Date__c&#124;Package_Flight__r/Campaign_End_Date__c&#124;Package_Flight__r/Duration_And_Type__c&#124;Package_Flight__r/Target__c&#124;Package_Flight__r/Market_Type__c&#124;Package_Flight__r/Target_Population__c&#124;Package_Flight__r/Type__c\"],\"fieldLabelsPipeDelimited\":[\"Map Location #&#124;Media Type&#124;# of Panels&#124;Panel ID&#124;TAB ID&#124;Network Name&#124;Description&#124;Network Description&#124;Face Dir&#124;Weekly Total 18+ Imps&#124;Target In-Market Imps&#124;Target Total Imps&#124;Weekly TRP&#124;Plan TRP&#124;Reach %&#124;Freq&#124;Discount %&#124;4-Wk Proposed Price&#124;Total Price&#124;CPM&#124;CPP&#124;Unit Size* (HxW)&#124;Illum (Y/N)&#124;Hours of Operation&#124;Line Item Comments&#124;Flight Comments&#124;Package Comments&#124;Face Side&#124;Network Notes&#124;Timing&#124;Media Product&#124;Ride Order&#124;Average Daily Spots&#124;Production&#124;Additional Cost&#124;Division&#124;Market Name&#124;Package Name&#124;Flight Name&#124;Start Date&#124;End Date&#124;Duration&#124;Target&#124;Market Type&#124;Target Population&#124;Buy Type\"],\"description\":\"Multi Package Subtitle\",\"buyType\":\"Network/Custom\"}],\"contentDocumentId\":\"05850000000PJRpAAO\",\"clientContactInformation\":\"Bipin Nepani\\n\\n \\n\\nE   bipin@appirio.com\",\"clientCompanyName\":\"Clear Channel Outdoor\",\"attachmentsUrl\":\"https://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/\",\"appendixes\":[{\"title\":\"00PW0000000XMsLMAW_maps.pdf\",\"showTitle\":true,\"showAppendixEntry\":true,\"salesforceUrl\":\"https://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/00PW0000000XMsLMAW/Body\",\"pathOnClient\":\"00PW0000000XMsLMAW_maps.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"Map\",\"buyType\":null},{\"title\":\"00PW0000000XMsVMAW_maps.pdf\",\"showTitle\":true,\"showAppendixEntry\":true,\"salesforceUrl\":\"https://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/00PW0000000XMsVMAW/Body\",\"pathOnClient\":\"00PW0000000XMsVMAW_maps.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"Map\",\"buyType\":null},{\"title\":\"00PW0000000XMsQMAW_maps.pdf\",\"showTitle\":true,\"showAppendixEntry\":true,\"salesforceUrl\":\"https://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/00PW0000000XMsQMAW/Body\",\"pathOnClient\":\"00PW0000000XMsQMAW_maps.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"Map\",\"buyType\":null}],\"agencyName\":null,\"agencyContactInformation\":null}";
			
			jsonString = "{\"versionNumber\":\"V.001\",\"title\":\"Multi Package Title\",\"subTitle\":\"Multi Package Subtitle\",\"showTotalProgramSummary\":true,\"showTimeAndDateStamp\":true,\"showTableOfContents\":true,\"showPageNumbering\":true,\"showIndividualMarketSummary\":true,\"showIndividualFlightSummary\":true,\"showCoverPage\":true,\"shippingInstructionsUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Name%2C+Address1__c%2C+Address2__c%2C+Addressee__c%2C+Attention__c%2C+City__c%2C+Country__c%2C+Division__r.Name%2C+Notes__c%2C+Phone__c%2C+Receiving_Time__c%2C+Sales_Plan__c%2C+State__c%2C+Zip_Code__c+FROM+Plan_Shipping_Instruction__c+WHERE+Sales_Plan__c+%3D+%27a13W0000001CRqPIAW%27\",\"sessionId\":\"00DW00000073REe!ASAAQEQXZu049gB3ngYBjYtxKlcX7z3SLhjHhVW5jNQCMfeJ39EBNu_7Czhb_3St9rT59joJzm0.V60zKrdfPunJvwdrMXs8\",\"packageSummaryUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Id%2C+Package_Name__c%2C+Name%2C+Total_Price__c+FROM+Sales_Plan_Package__c+WHERE+Campaign_Sales_Plan__c+%3D+%27a13W0000001CRqPIAW%27\",\"outputFileName\":\"a13W0000001CRqPIAW Multi Package Output\",\"marketName\":null,\"marketContactInformation\":null,\"mapPanelOrderPrefUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Sort_Sequence__c%2C+Flight__c%2C+Panel__c+FROM+Map_Panel_Order_Pref__c+WHERE+Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CRqPIAW%27+ORDER+BY+Flight__c%2C+Sort_Sequence__c\",\"insertContentVersionUrl\":\"https://cs13.salesforce.com/services/data/v27.0/sobjects/ContentVersion\",\"exportToXls\":false,\"exportToPdf\":true,\"excludeNetworkDetails\":true,\"excludeFlightLines\":false,\"email\":null,\"disclaimerUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT%20Disclaimer__c%2C%20Notes__c%2C%20Sequence__c%2C%20Name%2C%20isShippingInstruction__c%2C%20Media_Types__c%2C%20Division__c%20FROM%20Proposal_Disclaimer__c%20ORDER%20BY%20Sequence__c\",\"dateTimeStamp\":\"10/28/2013 00:47 AM PDT\",\"contents\":[{\"title\":\"Multi Package Title\",\"showTitle\":null,\"showAppendixEntry\":true,\"salesforceUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Unit_Size__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c+FROM+Child_Flight_Lines__r%29%2C++Package_Flight__r.Package_Market__r.Package__r.Package_Name__c%2C++Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Id%2C+Package_Flight__r.Package_Market__r.Weekly_Total_18_Imps__c%2C++Package_Flight__r.Package_Market__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.CPM__c%2C+Package_Flight__r.Package_Market__r.CPP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Id%2C+Package_Flight__r.Package_Market__r.Package__r.Weekly_Total_18_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Discount__c%2C+Package_Flight__r.Package_Market__r.Package__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPM__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPP__c%2C++MapLocation_Number__c%2CMedia_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CNetwork_Name__c%2CLocation_Description__c%2CNetwork_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotal_Imps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CDiscount__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CUnit_Size__c%2CIllumination_yn__c%2CHours_of_Operation__c%2CComments__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CFacing__c%2CNetwork_Notes__c%2CTiming__c%2CMedia_Product__c%2CRide_Order__c%2CAverage_Daily_Spots__c%2CProduction__c%2CAdditional_Cost__c%2CAdditional_Cost_Type__c%2CPackage_Flight__r.Id%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Target_Population__c%2CPackage_Flight__r.Type__c%2C+Id%2C+Package_Flight__r.Media_Category__c+%2C+OB_Summ_Num__c++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CRqPIAW%27+ORDER+BY+Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Package__r.Name%2C+Package_Flight__r.Name+\",\"pathOnClient\":\"filea13W0000001CRqPIAW.xml\",\"fieldTypesPipeDelimited\":[\"String&#124;String&#124;Double&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Currency&#124;Currency&#124;Double&#124;Currency&#124;String&#124;String&#124;String&#124;String&#124;&#124;&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;Currency&#124;Currency&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;Double&#124;String\"],\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":[\"MapLocation_Number__c&#124;Media_Category__c&#124;Number_of_Panels__c&#124;Panel_Id_Label__c&#124;TAB_Id__c&#124;Network_Name__c&#124;Location_Description__c&#124;Network_Description__c&#124;Face_Direction__c&#124;Weekly_Total_18_Imps__c&#124;In_Mkt_Imps__c&#124;Total_Imps__c&#124;In_Mkt_TRP__c&#124;PlanTRP__c&#124;Plan_Imps_Reach_Perc__c&#124;Plan_Imps_Avg_Frequency__c&#124;Discount__c&#124;X4_Wk_Proposed_Price__c&#124;Total_Price_0d__c&#124;TotalInMarketCPM_0d__c&#124;CPP_0d__c&#124;Unit_Size__c&#124;Illumination_yn__c&#124;Hours_of_Operation__c&#124;Comments__c&#124;Package_Flight__r/Flight_Comments__c&#124;Package_Flight__r/Package_Comments__c&#124;Facing__c&#124;Network_Notes__c&#124;Timing__c&#124;Media_Product__c&#124;Ride_Order__c&#124;Average_Daily_Spots__c&#124;Production__c&#124;Additional_Cost__c&#124;Package_Flight__r/Division__c&#124;Package_Flight__r/Market_Name__c&#124;Package_Flight__r/Package_Name__c&#124;Package_Flight__r/Name&#124;Package_Flight__r/Campaign_Start_Date__c&#124;Package_Flight__r/Campaign_End_Date__c&#124;Package_Flight__r/Duration_And_Type__c&#124;Package_Flight__r/Target__c&#124;Package_Flight__r/Market_Type__c&#124;Package_Flight__r/Target_Population__c&#124;Package_Flight__r/Type__c\"],\"fieldLabelsPipeDelimited\":[\"Map Location #&#124;Media Type&#124;# of Panels&#124;Panel ID&#124;TAB ID&#124;Network Name&#124;Description&#124;Network Description&#124;Face Dir&#124;Weekly Total 18+ Imps&#124;Target In-Market Imps&#124;Target Total Imps&#124;Weekly TRP&#124;Plan TRP&#124;Reach %&#124;Freq&#124;Discount %&#124;4-Wk Proposed Price&#124;Total Price&#124;CPM&#124;CPP&#124;Unit Size* (HxW)&#124;Illum (Y/N)&#124;Hours of Operation&#124;Line Item Comments&#124;Flight Comments&#124;Package Comments&#124;Face Side&#124;Network Notes&#124;Timing&#124;Media Product&#124;Ride Order&#124;Average Daily Spots&#124;Production&#124;Additional Cost&#124;Division&#124;Market Name&#124;Package Name&#124;Flight Name&#124;Start Date&#124;End Date&#124;Duration&#124;Target&#124;Market Type&#124;Target Population&#124;Buy Type\"],\"description\":\"Multi Package Subtitle\",\"buyType\":\"Network/Custom\"}],\"contentDocumentId\":\"05850000000PJRpAAO\",\"clientContactInformation\":\"Bipin Nepani\\n\\n \\n\\nE   bipin@appirio.com\",\"clientCompanyName\":\"Clear Channel Outdoor\",\"attachmentsUrl\":\"https://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/\",\"appendixes\":[{\"title\":\"00PW0000000XMsLMAW_maps.pdf\",\"showTitle\":true,\"showAppendixEntry\":true,\"salesforceUrl\":\"https://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/00PW0000000XMsLMAW/Body\",\"pathOnClient\":\"00PW0000000XMsLMAW_maps.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"Map\",\"buyType\":null},{\"title\":\"00PW0000000XMsVMAW_maps.pdf\",\"showTitle\":true,\"showAppendixEntry\":true,\"salesforceUrl\":\"https://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/00PW0000000XMsVMAW/Body\",\"pathOnClient\":\"00PW0000000XMsVMAW_maps.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"Map\",\"buyType\":null},{\"title\":\"00PW0000000XMsQMAW_maps.pdf\",\"showTitle\":true,\"showAppendixEntry\":true,\"salesforceUrl\":\"https://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/00PW0000000XMsQMAW/Body\",\"pathOnClient\":\"00PW0000000XMsQMAW_maps.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"Map\",\"buyType\":null}],\"agencyName\":null,\"agencyContactInformation\":null}";
			
			jsonString="{\"versionNumber\":\"V.013\",\"title\":\"Shipping\",\"subTitle\":\"Greg, are you there?\",\"showTotalProgramSummary\":false,\"showTimeAndDateStamp\":true,\"showTableOfContents\":true,\"showPageNumbering\":true,\"showIndividualMarketSummary\":false,\"showIndividualFlightSummary\":false,\"showCoverPage\":true,\"shippingInstructionsUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Name%2C+Address1__c%2C+Address2__c%2C+Addressee__c%2C+Attention__c%2C+City__c%2C+Country__c%2C+Division__r.Name%2C+Notes__c%2C+Phone__c%2C+Receiving_Time__c%2C+Sales_Plan__c%2C+State__c%2C+Zip_Code__c+FROM+Plan_Shipping_Instruction__c+WHERE+Sales_Plan__c+%3D+%27a13W0000001CRqPIAW%27\",\"sessionId\":\"00DW00000073REe!ASAAQHO4.Yu9h_OdOnEVENYLE34Hrgoyf7R6lLwcC_feSHQPW_o8peuLCkQDo_DPeeejs20xgVqhJl9CQNMM22sU2BpjueiZ\",\"pdfCombinerCallback\":{\"callbackUrl\":\"https://cs13.salesforce.com/services/data/v27.0/sobjects/Plan_Output__c/a2DW000000044hlMAA?_HttpMethod=PATCH\",\"callbackContents\":\"{\"PDF_Output__c\": \"https://cs13.salesforce.com/sfc/servlet.shepherd/version/download/%PDFOutput%?asPdf=false\", \"Status__c\": \"%Status%\", \"Message__c\": \"%Message%\"}\"},\"packageSummaryUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Id%2C+Package_Name__c%2C+Name%2C+Total_Price__c+FROM+Sales_Plan_Package__c+WHERE+Campaign_Sales_Plan__c+%3D+%27a13W0000001CRqPIAW%27\",\"outputFileName\":\"a13W0000001CRqPIAW TOC Shipping etc.\",\"marketName\":null,\"marketContactInformation\":null,\"mapPanelOrderPrefUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Sort_Sequence__c%2C+Flight__c%2C+Panel__c+FROM+Map_Panel_Order_Pref__c+WHERE+Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CRqPIAW%27+ORDER+BY+Flight__c%2C+Sort_Sequence__c\",\"insertContentVersionUrl\":\"https://cs13.salesforce.com/services/data/v27.0/sobjects/ContentVersion\",\"exportToXls\":false,\"exportToPdf\":true,\"excludeNetworkDetails\":false,\"excludeFlightLines\":false,\"email\":null,\"disclaimerUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT%20Disclaimer__c%2C%20Notes__c%2C%20Sequence__c%2C%20Name%2C%20isShippingInstruction__c%2C%20Media_Types__c%2C%20Additional_Cost_Type__c%2C%20IsAdditionalCostRelated__c%2C%20Division__c%20FROM%20Proposal_Disclaimer__c%20ORDER%20BY%20Sequence__c\",\"dateTimeStamp\":\"11/07/2013 03:15 AM EST\",\"contents\":[{\"title\":\"Shipping\",\"showTitle\":null,\"showAppendixEntry\":true,\"salesforceUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Unit_Size__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c+FROM+Child_Flight_Lines__r%29%2C++Package_Flight__r.Package_Market__r.Package__r.Package_Name__c%2C++Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Id%2C+Package_Flight__r.Package_Market__r.Weekly_Total_18_Imps__c%2C++Package_Flight__r.Package_Market__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.CPM__c%2C+Package_Flight__r.Package_Market__r.CPP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Id%2C+Package_Flight__r.Package_Market__r.Package__r.Weekly_Total_18_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Discount__c%2C+Package_Flight__r.Package_Market__r.Package__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPM__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPP__c%2C++MapLocation_Number__c%2CMedia_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CNetwork_Name__c%2CLocation_Description__c%2CNetwork_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotalMarketImps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CUnit_Size__c%2CIllumination_yn__c%2CComments__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CAdditional_Cost__c%2CPackage_Flight__r.Id%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Target_Population__c%2C+Package_Flight__r.Type__c+%2C+Id%2C+Package_Flight__r.Media_Category__c+%2C+OB_Summ_Num__c+%2C+Additional_Cost_Type__c++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CRqPIAW%27+ORDER+BY+Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Package__r.Name%2C+Package_Flight__r.Name+\",\"pathOnClient\":\"filea13W0000001CRqPIAW.xml\",\"fieldTypesPipeDelimited\":[\"String&#124;String&#124;Double&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Currency&#124;Currency&#124;Double&#124;Currency&#124;String&#124;String&#124;String&#124;&#124;&#124;Currency&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;Double\"],\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":[\"MapLocation_Number__c&#124;Media_Category__c&#124;Number_of_Panels__c&#124;Panel_Id_Label__c&#124;TAB_Id__c&#124;Network_Name__c&#124;Location_Description__c&#124;Network_Description__c&#124;Face_Direction__c&#124;Weekly_Total_18_Imps__c&#124;In_Mkt_Imps__c&#124;TotalMarketImps__c&#124;In_Mkt_TRP__c&#124;PlanTRP__c&#124;Plan_Imps_Reach_Perc__c&#124;Plan_Imps_Avg_Frequency__c&#124;X4_Wk_Proposed_Price__c&#124;Total_Price_0d__c&#124;TotalInMarketCPM_0d__c&#124;CPP_0d__c&#124;Unit_Size__c&#124;Illumination_yn__c&#124;Comments__c&#124;Package_Flight__r/Flight_Comments__c&#124;Package_Flight__r/Package_Comments__c&#124;Additional_Cost__c&#124;Package_Flight__r/Division__c&#124;Package_Flight__r/Market_Name__c&#124;Package_Flight__r/Package_Name__c&#124;Package_Flight__r/Name&#124;Package_Flight__r/Campaign_Start_Date__c&#124;Package_Flight__r/Campaign_End_Date__c&#124;Package_Flight__r/Duration_And_Type__c&#124;Package_Flight__r/Target__c&#124;Package_Flight__r/Market_Type__c&#124;Package_Flight__r/Target_Population__c\"],\"fieldLabelsPipeDelimited\":[\"Map Location #&#124;Media Type&#124;# of Panels&#124;Panel ID&#124;TAB ID&#124;Network Name&#124;Description&#124;Network Description&#124;Face Dir&#124;Weekly Total 18+ Imps&#124;Target In-Market Imps&#124;Target Total Imps&#124;Weekly TRP&#124;Plan TRP&#124;Reach %&#124;Freq&#124;4-Wk Proposed Price&#124;Total Price&#124;CPM&#124;CPP&#124;Unit Size* (HxW)&#124;Illum (Y/N)&#124;Line Item Comments&#124;Flight Comments&#124;Package Comments&#124;Additional Cost&#124;Division&#124;Market Name&#124;Package Name&#124;Flight Name&#124;Start Date&#124;End Date&#124;Duration&#124;Target&#124;Market Type&#124;Target Pop for Trish!\"],\"description\":\"Greg, are you there?\",\"buyType\":\"Location\"}],\"contentDocumentId\":\"05850000000PJRpAAO\",\"clientContactInformation\":\"Martina Schmidtartinaschmidt@clearchannel.com\",\"clientCompanyName\":\"Clear Channel Outdoor\",\"attachmentsUrl\":\"https://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/\",\"appendixes\":[{\"title\":\"Proposal+ 7-24-13 Demo Attendee Summary.pdf\",\"showTitle\":null,\"showAppendixEntry\":true,\"salesforceUrl\":\"https://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/00PW0000000XQEVMA4/Body\",\"pathOnClient\":\"file00PW0000000XQEVMA4.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"Demo Attendee Sum\",\"buyType\":null},{\"title\":\"a1cW00000006HXtIAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":true,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001048.pdf\",\"pathOnClient\":\"a1cW00000006HXtIAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HXuIAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001025.pdf\",\"pathOnClient\":\"a1cW00000006HXuIAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HXvIAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001063.pdf\",\"pathOnClient\":\"a1cW00000006HXvIAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HXwIAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001060.pdf\",\"pathOnClient\":\"a1cW00000006HXwIAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HXxIAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001045.pdf\",\"pathOnClient\":\"a1cW00000006HXxIAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HXyIAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001015.pdf\",\"pathOnClient\":\"a1cW00000006HXyIAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HXzIAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001057.pdf\",\"pathOnClient\":\"a1cW00000006HXzIAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HY0IAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001061.pdf\",\"pathOnClient\":\"a1cW00000006HY0IAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HY1IAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001047.pdf\",\"pathOnClient\":\"a1cW00000006HY1IAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HY2IAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001036.pdf\",\"pathOnClient\":\"a1cW00000006HY2IAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HY3IAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001016.pdf\",\"pathOnClient\":\"a1cW00000006HY3IAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HY4IAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001059.pdf\",\"pathOnClient\":\"a1cW00000006HY4IAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HY5IAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001058.pdf\",\"pathOnClient\":\"a1cW00000006HY5IAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HY6IAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001046.pdf\",\"pathOnClient\":\"a1cW00000006HY6IAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HY7IAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001014.pdf\",\"pathOnClient\":\"a1cW00000006HY7IAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HY8IAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001008.pdf\",\"pathOnClient\":\"a1cW00000006HY8IAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HY9IAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001030.pdf\",\"pathOnClient\":\"a1cW00000006HY9IAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HYAIA2_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001029.pdf\",\"pathOnClient\":\"a1cW00000006HYAIA2_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HYBIA2_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001062.pdf\",\"pathOnClient\":\"a1cW00000006HYBIA2_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HYCIA2_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001007.pdf\",\"pathOnClient\":\"a1cW00000006HYCIA2_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HZaIAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001048.pdf\",\"pathOnClient\":\"a1cW00000006HZaIAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HZbIAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001025.pdf\",\"pathOnClient\":\"a1cW00000006HZbIAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HZcIAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001063.pdf\",\"pathOnClient\":\"a1cW00000006HZcIAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HZdIAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001060.pdf\",\"pathOnClient\":\"a1cW00000006HZdIAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HZeIAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001045.pdf\",\"pathOnClient\":\"a1cW00000006HZeIAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HZfIAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001015.pdf\",\"pathOnClient\":\"a1cW00000006HZfIAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HZgIAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001057.pdf\",\"pathOnClient\":\"a1cW00000006HZgIAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HZhIAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001061.pdf\",\"pathOnClient\":\"a1cW00000006HZhIAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HZiIAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001047.pdf\",\"pathOnClient\":\"a1cW00000006HZiIAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HZjIAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001036.pdf\",\"pathOnClient\":\"a1cW00000006HZjIAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HZkIAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001016.pdf\",\"pathOnClient\":\"a1cW00000006HZkIAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HZlIAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001059.pdf\",\"pathOnClient\":\"a1cW00000006HZlIAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HZmIAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001058.pdf\",\"pathOnClient\":\"a1cW00000006HZmIAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HZnIAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001046.pdf\",\"pathOnClient\":\"a1cW00000006HZnIAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HZoIAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001014.pdf\",\"pathOnClient\":\"a1cW00000006HZoIAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HZpIAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001008.pdf\",\"pathOnClient\":\"a1cW00000006HZpIAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HZqIAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001030.pdf\",\"pathOnClient\":\"a1cW00000006HZqIAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HZrIAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001029.pdf\",\"pathOnClient\":\"a1cW00000006HZrIAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HZsIAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001062.pdf\",\"pathOnClient\":\"a1cW00000006HZsIAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"a1cW00000006HZtIAM_bis_sheet.pdf\",\"showTitle\":null,\"showAppendixEntry\":false,\"salesforceUrl\":\"http://outdoorphotoliths.clearchanneloutdoor.com/dallas_fort_worth/40100000/Photoliths/056-001007.pdf\",\"pathOnClient\":\"a1cW00000006HZtIAM_bis_sheet.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"\",\"buyType\":null},{\"title\":\"00PW0000000XQEoMAO_maps.pdf\",\"showTitle\":true,\"showAppendixEntry\":true,\"salesforceUrl\":\"https://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/00PW0000000XQEoMAO/Body\",\"pathOnClient\":\"00PW0000000XQEoMAO_maps.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"Combo Map\",\"buyType\":null},{\"title\":\"00PW0000000XQEjMAO_maps.pdf\",\"showTitle\":true,\"showAppendixEntry\":true,\"salesforceUrl\":\"https://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/00PW0000000XQEjMAO/Body\",\"pathOnClient\":\"00PW0000000XQEjMAO_maps.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"DFW #1 Loc\",\"buyType\":null},{\"title\":\"00PW0000000XQEyMAO_maps.pdf\",\"showTitle\":true,\"showAppendixEntry\":true,\"salesforceUrl\":\"https://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/00PW0000000XQEyMAO/Body\",\"pathOnClient\":\"00PW0000000XQEyMAO_maps.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"Typical-Weekly GRP/TRP-100\",\"buyType\":null}],\"agencyName\":null,\"agencyContactInformation\":null}";

			jsonString="{\"versionNumber\":\"V.008\",\"title\":\"Output Testing\",\"subTitle\":\"Output Testing\",\"showTotalProgramSummary\":false,\"showTimeAndDateStamp\":false,\"showTableOfContents\":false,\"showPageNumbering\":false,\"showIndividualMarketSummary\":false,\"showIndividualFlightSummary\":false,\"showCoverPage\":true,\"shippingInstructionsUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Name%2C+Address1__c%2C+Address2__c%2C+Addressee__c%2C+Attention__c%2C+City__c%2C+Country__c%2C+Division__r.Name%2C+Notes__c%2C+Phone__c%2C+Receiving_Time__c%2C+Sales_Plan__c%2C+State__c%2C+Zip_Code__c+FROM+Plan_Shipping_Instruction__c+WHERE+Sales_Plan__c+%3D+%27a13W0000001CRq5IAG%27\",\"sessionId\":\"00DW00000073REe!ASAAQHO4.Yu9h_OdOnEVENYLE34Hrgoyf7R6lLwcC_feSHQPW_o8peuLCkQDo_DPeeejs20xgVqhJl9CQNMM22sU2BpjueiZ\",\"packageSummaryUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Id%2C+Package_Name__c%2C+Name%2C+Total_Price__c+FROM+Sales_Plan_Package__c+WHERE+Campaign_Sales_Plan__c+%3D+%27a13W0000001CRq5IAG%27\",\"outputFileName\":\"a13W0000001CRq5IAG I-65583 - Mapping to Media Type for Audience\",\"marketName\":null,\"marketContactInformation\":null,\"mapPanelOrderPrefUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Sort_Sequence__c%2C+Flight__c%2C+Panel__c+FROM+Map_Panel_Order_Pref__c+WHERE+Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CRq5IAG%27+ORDER+BY+Flight__c%2C+Sort_Sequence__c\",\"insertContentVersionUrl\":\"https://cs13.salesforce.com/services/data/v27.0/sobjects/ContentVersion\",\"exportToXls\":false,\"exportToPdf\":true,\"excludeNetworkDetails\":false,\"excludeFlightLines\":false,\"email\":null,\"disclaimerUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT%20Disclaimer__c%2C%20Notes__c%2C%20Sequence__c%2C%20Name%2C%20isShippingInstruction__c%2C%20Media_Types__c%2C%20Additional_Cost_Type__c%2C%20IsAdditionalCostRelated__c%2C%20Division__c%20FROM%20Proposal_Disclaimer__c%20ORDER%20BY%20Sequence__c\",\"dateTimeStamp\":\"11/07/2013 03:28 AM EST\",\"contents\":[{\"title\":\"Output Testing\",\"showTitle\":null,\"showAppendixEntry\":true,\"salesforceUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Unit_Size__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c+FROM+Child_Flight_Lines__r%29%2C++Package_Flight__r.Package_Market__r.Package__r.Package_Name__c%2C++Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Id%2C+Package_Flight__r.Package_Market__r.Weekly_Total_18_Imps__c%2C++Package_Flight__r.Package_Market__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.CPM__c%2C+Package_Flight__r.Package_Market__r.CPP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Id%2C+Package_Flight__r.Package_Market__r.Package__r.Weekly_Total_18_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Discount__c%2C+Package_Flight__r.Package_Market__r.Package__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPM__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPP__c%2C++MapLocation_Number__c%2CMedia_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CLocation_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotalMarketImps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CIllumination_yn__c%2CComments__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CAdditional_Cost__c%2CPackage_Flight__r.Id%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2C+Package_Flight__r.Type__c+%2C+Id%2C+Package_Flight__r.Media_Category__c+%2C+OB_Summ_Num__c+%2C+Additional_Cost_Type__c++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CRq5IAG%27+ORDER+BY+Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Package__r.Name%2C+Package_Flight__r.Name+\",\"pathOnClient\":\"filea13W0000001CRq5IAG.xml\",\"fieldTypesPipeDelimited\":[\"String&#124;String&#124;Double&#124;String&#124;String&#124;String&#124;String&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Currency&#124;Currency&#124;Double&#124;Currency&#124;String&#124;String&#124;&#124;&#124;Currency&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String\"],\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":[\"MapLocation_Number__c&#124;Media_Category__c&#124;Number_of_Panels__c&#124;Panel_Id_Label__c&#124;TAB_Id__c&#124;Location_Description__c&#124;Face_Direction__c&#124;Weekly_Total_18_Imps__c&#124;In_Mkt_Imps__c&#124;TotalMarketImps__c&#124;In_Mkt_TRP__c&#124;PlanTRP__c&#124;Plan_Imps_Reach_Perc__c&#124;Plan_Imps_Avg_Frequency__c&#124;X4_Wk_Proposed_Price__c&#124;Total_Price_0d__c&#124;TotalInMarketCPM_0d__c&#124;CPP_0d__c&#124;Illumination_yn__c&#124;Comments__c&#124;Package_Flight__r/Flight_Comments__c&#124;Package_Flight__r/Package_Comments__c&#124;Additional_Cost__c&#124;Package_Flight__r/Division__c&#124;Package_Flight__r/Market_Type__c&#124;Package_Flight__r/Market_Name__c&#124;Package_Flight__r/Package_Name__c&#124;Package_Flight__r/Name&#124;Package_Flight__r/Campaign_Start_Date__c&#124;Package_Flight__r/Campaign_End_Date__c&#124;Package_Flight__r/Duration_And_Type__c&#124;Package_Flight__r/Target__c\"],\"fieldLabelsPipeDelimited\":[\"Map Location #&#124;Media Type&#124;# of Panels&#124;Panel ID&#124;TAB ID&#124;Description&#124;Face Dir&#124;Weekly Total 18+ Imps&#124;Target In-Market Imps&#124;Target Total Imps&#124;Weekly TRP&#124;Plan TRP&#124;Reach %&#124;Freq&#124;4-Wk Proposed Price&#124;Total Price&#124;CPM&#124;CPP&#124;Illum (Y/N)&#124;Line Item Comments&#124;Flight Comments&#124;Package Comments&#124;Additional Cost&#124;Division&#124;Market Type&#124;Market Name&#124;Package Name&#124;Flight Name&#124;Start Date&#124;End Date&#124;Duration&#124;Target\"],\"description\":\"Output Testing\",\"buyType\":\"Location\"}],\"contentDocumentId\":\"05850000000PJRpAAO\",\"clientContactInformation\":\"Martina Schmidt \\n   212-812-006 \\n martinaschmidt@clearchannel.com\",\"clientCompanyName\":\"Clear Channel Outdoor\",\"attachmentsUrl\":\"https://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/\",\"appendixes\":[],\"agencyName\":null,\"agencyContactInformation\":null}";
			
			jsonString="{\"versionNumber\":\"V.008\",\"title\":\"Output Testing\",\"subTitle\":\"Output Testing\",\"showTotalProgramSummary\":false,\"showTimeAndDateStamp\":false,\"showTableOfContents\":false,\"showPageNumbering\":false,\"showIndividualMarketSummary\":false,\"showIndividualFlightSummary\":false,\"showCoverPage\":true,\"shippingInstructionsUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Name%2C+Address1__c%2C+Address2__c%2C+Addressee__c%2C+Attention__c%2C+City__c%2C+Country__c%2C+Division__r.Name%2C+Notes__c%2C+Phone__c%2C+Receiving_Time__c%2C+Sales_Plan__c%2C+State__c%2C+Zip_Code__c+FROM+Plan_Shipping_Instruction__c+WHERE+Sales_Plan__c+%3D+%27a13W0000001CRq5IAG%27\",\"sessionId\":\"00DW00000073REe!ASAAQHO4.Yu9h_OdOnEVENYLE34Hrgoyf7R6lLwcC_feSHQPW_o8peuLCkQDo_DPeeejs20xgVqhJl9CQNMM22sU2BpjueiZ\",\"packageSummaryUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Id%2C+Package_Name__c%2C+Name%2C+Total_Price__c+FROM+Sales_Plan_Package__c+WHERE+Campaign_Sales_Plan__c+%3D+%27a13W0000001CRq5IAG%27\",\"outputFileName\":\"a13W0000001CRq5IAG I-65583 - Mapping to Media Type for Audience\",\"marketName\":null,\"marketContactInformation\":null,\"mapPanelOrderPrefUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Sort_Sequence__c%2C+Flight__c%2C+Panel__c+FROM+Map_Panel_Order_Pref__c+WHERE+Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CRq5IAG%27+ORDER+BY+Flight__c%2C+Sort_Sequence__c\",\"insertContentVersionUrl\":\"https://cs13.salesforce.com/services/data/v27.0/sobjects/ContentVersion\",\"exportToXls\":false,\"exportToPdf\":true,\"excludeNetworkDetails\":false,\"excludeFlightLines\":false,\"email\":null,\"disclaimerUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT%20Disclaimer__c%2C%20Notes__c%2C%20Sequence__c%2C%20Name%2C%20isShippingInstruction__c%2C%20Media_Types__c%2C%20Additional_Cost_Type__c%2C%20IsAdditionalCostRelated__c%2C%20Division__c%20FROM%20Proposal_Disclaimer__c%20ORDER%20BY%20Sequence__c\",\"dateTimeStamp\":\"11/07/2013 03:28 AM EST\",\"contents\":[{\"title\":\"Output Testing\",\"showTitle\":null,\"showAppendixEntry\":true,\"salesforceUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Unit_Size__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c+FROM+Child_Flight_Lines__r%29%2C++Package_Flight__r.Package_Market__r.Package__r.Package_Name__c%2C++Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Id%2C+Package_Flight__r.Package_Market__r.Weekly_Total_18_Imps__c%2C++Package_Flight__r.Package_Market__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.CPM__c%2C+Package_Flight__r.Package_Market__r.CPP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Id%2C+Package_Flight__r.Package_Market__r.Package__r.Weekly_Total_18_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Discount__c%2C+Package_Flight__r.Package_Market__r.Package__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPM__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPP__c%2C++MapLocation_Number__c%2CMedia_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CLocation_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotalMarketImps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CIllumination_yn__c%2CComments__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CAdditional_Cost__c%2CPackage_Flight__r.Id%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2C+Package_Flight__r.Type__c+%2C+Id%2C+Package_Flight__r.Media_Category__c+%2C+OB_Summ_Num__c+%2C+Additional_Cost_Type__c++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CRq5IAG%27+ORDER+BY+Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Package__r.Name%2C+Package_Flight__r.Name+\",\"pathOnClient\":\"filea13W0000001CRq5IAG.xml\",\"fieldTypesPipeDelimited\":[\"String&#124;String&#124;Double&#124;String&#124;String&#124;String&#124;String&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Currency&#124;Currency&#124;Double&#124;Currency&#124;String&#124;String&#124;&#124;&#124;Currency&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String\"],\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":[\"MapLocation_Number__c&#124;Media_Category__c&#124;Number_of_Panels__c&#124;Panel_Id_Label__c&#124;TAB_Id__c&#124;Location_Description__c&#124;Face_Direction__c&#124;Weekly_Total_18_Imps__c&#124;In_Mkt_Imps__c&#124;TotalMarketImps__c&#124;In_Mkt_TRP__c&#124;PlanTRP__c&#124;Plan_Imps_Reach_Perc__c&#124;Plan_Imps_Avg_Frequency__c&#124;X4_Wk_Proposed_Price__c&#124;Total_Price_0d__c&#124;TotalInMarketCPM_0d__c&#124;CPP_0d__c&#124;Illumination_yn__c&#124;Comments__c&#124;Package_Flight__r/Flight_Comments__c&#124;Package_Flight__r/Package_Comments__c&#124;Additional_Cost__c&#124;Package_Flight__r/Division__c&#124;Package_Flight__r/Market_Type__c&#124;Package_Flight__r/Market_Name__c&#124;Package_Flight__r/Package_Name__c&#124;Package_Flight__r/Name&#124;Package_Flight__r/Campaign_Start_Date__c&#124;Package_Flight__r/Campaign_End_Date__c&#124;Package_Flight__r/Duration_And_Type__c&#124;Package_Flight__r/Target__c\"],\"fieldLabelsPipeDelimited\":[\"Map Location #&#124;Media Type&#124;# of Panels&#124;Panel ID&#124;TAB ID&#124;Description&#124;Face Dir&#124;Weekly Total 18+ Imps&#124;Target In-Market Imps&#124;Target Total Imps&#124;Weekly TRP&#124;Plan TRP&#124;Reach %&#124;Freq&#124;4-Wk Proposed Price&#124;Total Price&#124;CPM&#124;CPP&#124;Illum (Y/N)&#124;Line Item Comments&#124;Flight Comments&#124;Package Comments&#124;Additional Cost&#124;Division&#124;Market Type&#124;Market Name&#124;Package Name&#124;Flight Name&#124;Start Date&#124;End Date&#124;Duration&#124;Target\"],\"description\":\"Output Testing\",\"buyType\":\"Location\"}],\"contentDocumentId\":\"05850000000PJRpAAO\",\"clientContactInformation\":\"Martina Schmidt\\n99 Park Ave, 2 Fl\\nNew York, NY 10017\\nP   212-812-0068\\nE   martinaschmidt@clearchannel.com\",\"clientCompanyName\":\"Clear Channel Outdoor\",\"attachmentsUrl\":\"https://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/\",\"appendixes\":[],\"agencyName\":null,\"agencyContactInformation\":null}";
			
			jsonString="{\"versionNumber\":\"V.008\",\"title\":\"Output Testing\",\"subTitle\":\"Output Testing\",\"showTotalProgramSummary\":true,\"showTimeAndDateStamp\":false,\"showTableOfContents\":false,\"showPageNumbering\":false,\"showIndividualMarketSummary\":false,\"showIndividualFlightSummary\":false,\"showCoverPage\":true,\"shippingInstructionsUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Name%2C+Address1__c%2C+Address2__c%2C+Addressee__c%2C+Attention__c%2C+City__c%2C+Country__c%2C+Division__r.Name%2C+Notes__c%2C+Phone__c%2C+Receiving_Time__c%2C+Sales_Plan__c%2C+State__c%2C+Zip_Code__c+FROM+Plan_Shipping_Instruction__c+WHERE+Sales_Plan__c+%3D+%27a13W0000001CRpgIAG%27\",\"sessionId\":\"00DW00000073REe!ASAAQHO4.Yu9h_OdOnEVENYLE34Hrgoyf7R6lLwcC_feSHQPW_o8peuLCkQDo_DPeeejs20xgVqhJl9CQNMM22sU2BpjueiZ\",\"packageSummaryUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Id%2C+Package_Name__c%2C+Name%2C+Total_Price__c+FROM+Sales_Plan_Package__c+WHERE+Campaign_Sales_Plan__c+%3D+%27a13W0000001CRpgIAG%27\",\"outputFileName\":\"a13W0000001CRpgIAG I-65583 - Mapping to Media Type for Audience\",\"marketName\":null,\"marketContactInformation\":null,\"mapPanelOrderPrefUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Sort_Sequence__c%2C+Flight__c%2C+Panel__c+FROM+Map_Panel_Order_Pref__c+WHERE+Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CRpgIAG%27+ORDER+BY+Flight__c%2C+Sort_Sequence__c\",\"insertContentVersionUrl\":\"https://cs13.salesforce.com/services/data/v27.0/sobjects/ContentVersion\",\"exportToXls\":false,\"exportToPdf\":true,\"excludeNetworkDetails\":false,\"excludeFlightLines\":false,\"email\":null,\"disclaimerUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT%20Disclaimer__c%2C%20Notes__c%2C%20Sequence__c%2C%20Name%2C%20isShippingInstruction__c%2C%20Media_Types__c%2C%20Additional_Cost_Type__c%2C%20IsAdditionalCostRelated__c%2C%20Division__c%20FROM%20Proposal_Disclaimer__c%20ORDER%20BY%20Sequence__c\",\"dateTimeStamp\":\"11/07/2013 03:28 AM EST\",\"contents\":[{\"title\":\"Output Testing\",\"showTitle\":null,\"showAppendixEntry\":true,\"salesforceUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Unit_Size__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c+FROM+Child_Flight_Lines__r%29%2C++Package_Flight__r.Package_Market__r.Package__r.Package_Name__c%2C++Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Id%2C+Package_Flight__r.Package_Market__r.Weekly_Total_18_Imps__c%2C++Package_Flight__r.Package_Market__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.CPM__c%2C+Package_Flight__r.Package_Market__r.CPP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Id%2C+Package_Flight__r.Package_Market__r.Package__r.Weekly_Total_18_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Discount__c%2C+Package_Flight__r.Package_Market__r.Package__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPM__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPP__c%2C++MapLocation_Number__c%2CMedia_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CLocation_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotalMarketImps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CIllumination_yn__c%2CComments__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CAdditional_Cost__c%2CPackage_Flight__r.Id%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2C+Package_Flight__r.Type__c+%2C+Id%2C+Package_Flight__r.Media_Category__c+%2C+OB_Summ_Num__c+%2C+Additional_Cost_Type__c++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CRpgIAG%27+ORDER+BY+Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Package__r.Name%2C+Package_Flight__r.Name+\",\"pathOnClient\":\"filea13W0000001CRpgIAG.xml\",\"fieldTypesPipeDelimited\":[\"String&#124;String&#124;Double&#124;String&#124;String&#124;String&#124;String&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Currency&#124;Currency&#124;Double&#124;Currency&#124;String&#124;String&#124;&#124;&#124;Currency&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String\"],\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":[\"MapLocation_Number__c&#124;Media_Category__c&#124;Number_of_Panels__c&#124;Panel_Id_Label__c&#124;TAB_Id__c&#124;Location_Description__c&#124;Face_Direction__c&#124;Weekly_Total_18_Imps__c&#124;In_Mkt_Imps__c&#124;TotalMarketImps__c&#124;In_Mkt_TRP__c&#124;PlanTRP__c&#124;Plan_Imps_Reach_Perc__c&#124;Plan_Imps_Avg_Frequency__c&#124;X4_Wk_Proposed_Price__c&#124;Total_Price_0d__c&#124;TotalInMarketCPM_0d__c&#124;CPP_0d__c&#124;Illumination_yn__c&#124;Comments__c&#124;Package_Flight__r/Flight_Comments__c&#124;Package_Flight__r/Package_Comments__c&#124;Additional_Cost__c&#124;Package_Flight__r/Division__c&#124;Package_Flight__r/Market_Type__c&#124;Package_Flight__r/Market_Name__c&#124;Package_Flight__r/Package_Name__c&#124;Package_Flight__r/Name&#124;Package_Flight__r/Campaign_Start_Date__c&#124;Package_Flight__r/Campaign_End_Date__c&#124;Package_Flight__r/Duration_And_Type__c&#124;Package_Flight__r/Target__c\"],\"fieldLabelsPipeDelimited\":[\"Map Location #&#124;Media Type&#124;# of Panels&#124;Panel ID&#124;TAB ID&#124;Description&#124;Face Dir&#124;Weekly Total 18+ Imps&#124;Target In-Market Imps&#124;Target Total Imps&#124;Weekly TRP&#124;Plan TRP&#124;Reach %&#124;Freq&#124;4-Wk Proposed Price&#124;Total Price&#124;CPM&#124;CPP&#124;Illum (Y/N)&#124;Line Item Comments&#124;Flight Comments&#124;Package Comments&#124;Additional Cost&#124;Division&#124;Market Type&#124;Market Name&#124;Package Name&#124;Flight Name&#124;Start Date&#124;End Date&#124;Duration&#124;Target\"],\"description\":\"Output Testing\",\"buyType\":\"Location\"}],\"contentDocumentId\":\"05850000000PJRpAAO\",\"clientContactInformation\":\"Martina Schmidt\\n99 Park Ave, 2 Fl\\nNew York, NY 10017\\nP   212-812-0068\\nE   martinaschmidt@clearchannel.com\",\"clientCompanyName\":\"Clear Channel Outdoor\",\"attachmentsUrl\":\"https://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/\",\"appendixes\":[],\"agencyName\":null,\"agencyContactInformation\":null}";
			
			jsonString="{\"versionNumber\":\"V.008\",\"title\":\"\",\"subTitle\":\"\",\"showTotalProgramSummary\":true,\"showTimeAndDateStamp\":false,\"showTableOfContents\":true,\"showPageNumbering\":false,\"showIndividualMarketSummary\":false,\"showIndividualFlightSummary\":false,\"showCoverPage\":true,\"shippingInstructionsUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Name%2C+Address1__c%2C+Address2__c%2C+Addressee__c%2C+Attention__c%2C+City__c%2C+Country__c%2C+Division__r.Name%2C+Notes__c%2C+Phone__c%2C+Receiving_Time__c%2C+Sales_Plan__c%2C+State__c%2C+Zip_Code__c+FROM+Plan_Shipping_Instruction__c+WHERE+Sales_Plan__c+%3D+%27a13W0000001CRpgIAG%27\",\"sessionId\":\"00DW00000073REe!ASAAQO9uHSs7URFbji06VWjalbIu.kT3TCYCoHPCRDYw8jqoEQbSQyVLNKqJNNY3D.m1cPe7JAQK72zG52MuniiL39WeI.Mo\",\"packageSummaryUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Id%2C+Package_Name__c%2C+Name%2C+Total_Price__c+FROM+Sales_Plan_Package__c+WHERE+Campaign_Sales_Plan__c+%3D+%27a13W0000001CRpgIAG%27\",\"outputFileName\":\"a13W0000001CRpgIAG QTE-SCP-11/6/2013\",\"marketName\":null,\"marketContactInformation\":null,\"mapPanelOrderPrefUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Sort_Sequence__c%2C+Flight__c%2C+Panel__c+FROM+Map_Panel_Order_Pref__c+WHERE+Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CRpgIAG%27+ORDER+BY+Flight__c%2C+Sort_Sequence__c\",\"insertContentVersionUrl\":\"https://cs13.salesforce.com/services/data/v27.0/sobjects/ContentVersion\",\"exportToXls\":false,\"exportToPdf\":true,\"excludeNetworkDetails\":false,\"excludeFlightLines\":false,\"email\":null,\"disclaimerUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT%20Disclaimer__c%2C%20Notes__c%2C%20Sequence__c%2C%20Name%2C%20isShippingInstruction__c%2C%20Media_Types__c%2C%20Additional_Cost_Type__c%2C%20IsAdditionalCostRelated__c%2C%20Division__c%20FROM%20Proposal_Disclaimer__c%20ORDER%20BY%20Sequence__c\",\"dateTimeStamp\":\"11/07/2013 08:37 AM EST\",\"contents\":[{\"title\":\"\",\"showTitle\":null,\"showAppendixEntry\":true,\"salesforceUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Unit_Size__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c%2C+In_Mkt_Perc_Comp__c+FROM+Child_Flight_Lines__r%29%2C++Package_Flight__r.Package_Market__r.Package__r.Package_Name__c%2C++Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Id%2C+Package_Flight__r.Package_Market__r.Weekly_Total_18_Imps__c%2C++Package_Flight__r.Package_Market__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.CPM__c%2C+Package_Flight__r.Package_Market__r.CPP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Id%2C+Package_Flight__r.Package_Market__r.Package__r.Weekly_Total_18_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Discount__c%2C+Package_Flight__r.Package_Market__r.Package__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPM__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPP__c%2C++MapLocation_Number__c%2CMedia_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CNetwork_Name__c%2CLocation_Description__c%2CNetwork_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotalMarketImps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CDiscount__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CUnit_Size__c%2CIllumination_yn__c%2CMax_of_Spots_per_Loop__c%2CHours_of_Operation__c%2CComments__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CIn_Mkt_Perc_Comp__c%2CAdditional_Cost__c%2CPackage_Flight__r.Id%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2C+Package_Flight__r.Type__c+%2C+Id%2C+Package_Flight__r.Media_Category__c+%2C+OB_Summ_Num__c+%2C+Additional_Cost_Type__c++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CRpgIAG%27+ORDER+BY+Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Package__r.Name%2C+Package_Flight__r.Name+\",\"pathOnClient\":\"filea13W0000001CRpgIAG.xml\",\"fieldTypesPipeDelimited\":[\"String&#124;String&#124;Double&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Currency&#124;Currency&#124;Double&#124;Currency&#124;String&#124;String&#124;String&#124;String&#124;String&#124;&#124;&#124;Double&#124;Currency&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String\"],\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":[\"MapLocation_Number__c&#124;Media_Category__c&#124;Number_of_Panels__c&#124;Panel_Id_Label__c&#124;TAB_Id__c&#124;Network_Name__c&#124;Location_Description__c&#124;Network_Description__c&#124;Face_Direction__c&#124;Weekly_Total_18_Imps__c&#124;In_Mkt_Imps__c&#124;TotalMarketImps__c&#124;In_Mkt_TRP__c&#124;PlanTRP__c&#124;Plan_Imps_Reach_Perc__c&#124;Plan_Imps_Avg_Frequency__c&#124;Discount__c&#124;X4_Wk_Proposed_Price__c&#124;Total_Price_0d__c&#124;TotalInMarketCPM_0d__c&#124;CPP_0d__c&#124;Unit_Size__c&#124;Illumination_yn__c&#124;Max_of_Spots_per_Loop__c&#124;Hours_of_Operation__c&#124;Comments__c&#124;Package_Flight__r/Flight_Comments__c&#124;Package_Flight__r/Package_Comments__c&#124;In_Mkt_Perc_Comp__c&#124;Additional_Cost__c&#124;Package_Flight__r/Division__c&#124;Package_Flight__r/Market_Name__c&#124;Package_Flight__r/Package_Name__c&#124;Package_Flight__r/Name&#124;Package_Flight__r/Campaign_Start_Date__c&#124;Package_Flight__r/Campaign_End_Date__c&#124;Package_Flight__r/Duration_And_Type__c&#124;Package_Flight__r/Target__c\"],\"fieldLabelsPipeDelimited\":[\"Map Location #&#124;Media Type&#124;# of Panels&#124;Panel ID&#124;TAB ID&#124;Network Name&#124;Description&#124;Network Description&#124;Face Dir&#124;Weekly Total 18+ Imps&#124;Target In-Market Imps&#124;Target Total Imps&#124;Weekly TRP&#124;Plan TRP&#124;Reach %&#124;Freq&#124;Discount %&#124;4-Wk Proposed Price&#124;Total Price&#124;CPM&#124;CPP&#124;Unit Size* (HxW)&#124;Illum (Y/N)&#124;Max # of Spots per Loop&#124;Hours of Operation&#124;Line Item Comments&#124;Flight Comments&#124;Package Comments&#124;In Mkt Perc Comp&#124;Additional Cost&#124;Division&#124;Market Name&#124;Package Name&#124;Flight Name&#124;Start Date&#124;End Date&#124;Duration&#124;Target\"],\"description\":\"\",\"buyType\":\"Network/Custom\"}],\"contentDocumentId\":\"05850000000PJRpAAO\",\"clientContactInformation\":\"Jarrod Kingston\\n\\n \\n\\nE   jkingston@appirio.com\",\"clientCompanyName\":\"Clear Channel Outdoor\",\"attachmentsUrl\":\"https://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/\",\"appendixes\":[],\"agencyName\":null,\"agencyContactInformation\":null}";

			//multi package plan
			jsonString = "{\"versionNumber\":\"V.004\",\"title\":\"Multi Package Title\",\"subTitle\":\"Multi Package Sub Title\",\"showTotalProgramSummary\":false,\"showTimeAndDateStamp\":true,\"showTableOfContents\":true,\"showPageNumbering\":true,\"showIndividualMarketSummary\":false,\"showIndividualFlightSummary\":false,\"showCoverPage\":true,\"shippingInstructionsUrl\":\"http://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Name%2C+Address1__c%2C+Address2__c%2C+Addressee__c%2C+Attention__c%2C+City__c%2C+Country__c%2C+Division__r.Name%2C+Notes__c%2C+Phone__c%2C+Receiving_Time__c%2C+Sales_Plan__c%2C+State__c%2C+Zip_Code__c+FROM+Plan_Shipping_Instruction__c+WHERE+Sales_Plan__c+%3D+%27a13W0000001CFT0IAO%27\",\"sessionId\":\"00DW00000073REe!ASAAQIJn2FQ5s_Er7I5vFfKKx.2MI7CWbo6H0_2oKE7_3p3.l5VoaPvEQZCPzrzEMf_tPCsSC4M0cfotE4dL7YVZhyq9xhy2\",\"packageSummaryUrl\":\"http://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Id%2C+Package_Name__c%2C+Name%2C+Total_Price__c+FROM+Sales_Plan_Package__c+WHERE+Campaign_Sales_Plan__c+%3D+%27a13W0000001CFT0IAO%27\",\"outputFileName\":\"a13W0000001CFT0IAO CPT-Test-test-Oct-2013 - v1\",\"marketName\":null,\"marketContactInformation\":null,\"mapPanelOrderPrefUrl\":\"http://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Sort_Sequence__c%2C+Flight__c%2C+Panel__c+FROM+Map_Panel_Order_Pref__c+WHERE+Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CFT0IAO%27+ORDER+BY+Flight__c%2C+Sort_Sequence__c\",\"insertContentVersionUrl\":\"http://cs13.salesforce.com/services/data/v27.0/sobjects/ContentVersion\",\"exportToXls\":false,\"exportToPdf\":true,\"excludeNetworkDetails\":false,\"excludeFlightLines\":false,\"email\":null,\"disclaimerUrl\":\"http://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT%20Disclaimer__c%2C%20Notes__c%2C%20Sequence__c%2C%20Name%2C%20isShippingInstruction__c%2C%20Media_Types__c%2C%20Additional_Cost_Type__c%2C%20IsAdditionalCostRelated__c%2C%20Division__c%20FROM%20Proposal_Disclaimer__c%20ORDER%20BY%20Sequence__c\",\"dateTimeStamp\":\"11/06/2013 10:14 PM PST\",\"contents\":[{\"title\":\"Multi Package Title\",\"showTitle\":null,\"showAppendixEntry\":true,\"salesforceUrl\":\"http://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c+FROM+Child_Flight_Lines__r%29%2C++Package_Flight__r.Package_Market__r.Package__r.Package_Name__c%2C++Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Id%2C+Package_Flight__r.Package_Market__r.Weekly_Total_18_Imps__c%2C++Package_Flight__r.Package_Market__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.CPM__c%2C+Package_Flight__r.Package_Market__r.CPP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Id%2C+Package_Flight__r.Package_Market__r.Package__r.Weekly_Total_18_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Discount__c%2C+Package_Flight__r.Package_Market__r.Package__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPM__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPP__c%2C++MapLocation_Number__c%2CMedia_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CNetwork_Name__c%2CLocation_Description__c%2CNetwork_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotalMarketImps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CDiscount__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CIllumination_yn__c%2CMax_of_Spots_per_Loop__c%2CHours_of_Operation__c%2CComments__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CProduction__c%2CAdditional_Cost__c%2CTax_Amt__c%2CIn_Mkt_Perc_Comp__c%2CMedia_Product__c%2CRide_Order__c%2CAverage_Daily_Spots__c%2CPackage_Flight__r.Id%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Target_Population__c%2CPackage_Flight__r.Type__c%2C+Id%2C+Package_Flight__r.Media_Category__c+%2C+OB_Summ_Num__c+%2C+Additional_Cost_Type__c++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CFT0IAO%27+ORDER+BY+Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Package__r.Name%2C+Package_Flight__r.Name+\",\"pathOnClient\":\"filea13W0000001CFT0IAO.xml\",\"fieldTypesPipeDelimited\":[\"String&#124;String&#124;Double&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Currency&#124;Currency&#124;Double&#124;Currency&#124;String&#124;String&#124;String&#124;String&#124;String&#124;&#124;&#124;Currency&#124;Currency&#124;Currency&#124;Double&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;Double&#124;String\"],\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":[\"MapLocation_Number__c&#124;Media_Category__c&#124;Number_of_Panels__c&#124;Panel_Id_Label__c&#124;TAB_Id__c&#124;Network_Name__c&#124;Location_Description__c&#124;Network_Description__c&#124;Face_Direction__c&#124;Weekly_Total_18_Imps__c&#124;In_Mkt_Imps__c&#124;TotalMarketImps__c&#124;In_Mkt_TRP__c&#124;PlanTRP__c&#124;Plan_Imps_Reach_Perc__c&#124;Plan_Imps_Avg_Frequency__c&#124;Discount__c&#124;X4_Wk_Proposed_Price__c&#124;Total_Price_0d__c&#124;TotalInMarketCPM_0d__c&#124;CPP_0d__c&#124;Illumination_yn__c&#124;Max_of_Spots_per_Loop__c&#124;Hours_of_Operation__c&#124;Comments__c&#124;Package_Flight__r/Flight_Comments__c&#124;Package_Flight__r/Package_Comments__c&#124;Production__c&#124;Additional_Cost__c&#124;Tax_Amt__c&#124;In_Mkt_Perc_Comp__c&#124;Media_Product__c&#124;Ride_Order__c&#124;Average_Daily_Spots__c&#124;Package_Flight__r/Division__c&#124;Package_Flight__r/Market_Name__c&#124;Package_Flight__r/Package_Name__c&#124;Package_Flight__r/Name&#124;Package_Flight__r/Campaign_Start_Date__c&#124;Package_Flight__r/Campaign_End_Date__c&#124;Package_Flight__r/Duration_And_Type__c&#124;Package_Flight__r/Target__c&#124;Package_Flight__r/Market_Type__c&#124;Package_Flight__r/Target_Population__c&#124;Package_Flight__r/Type__c\"],\"fieldLabelsPipeDelimited\":[\"Map Location #&#124;Media Type&#124;# of Panels&#124;Panel ID&#124;TAB ID&#124;Network Name&#124;Description&#124;Network Description&#124;Face Dir&#124;Weekly Total 18+ Imps&#124;Target In-Market Imps&#124;Target Total Imps&#124;Weekly TRP&#124;Plan TRP&#124;Reach %&#124;Freq&#124;Discount %&#124;4-Wk Proposed Price&#124;Total Price&#124;CPM&#124;CPP&#124;Illum (Y/N)&#124;Max # of Spots per Loop&#124;Hours of Operation&#124;Line Item Comments&#124;Flight Comments&#124;Package Comments&#124;Production&#124;Additional Cost&#124;Tax (Amt)&#124;In Mkt Perc Comp&#124;Media Product&#124;Ride Order&#124;Average Daily Spots&#124;Division&#124;Market Name&#124;Package Name&#124;Flight Name&#124;Start Date&#124;End Date&#124;Duration&#124;Target&#124;Market Type&#124;Target Population&#124;Buy Type\"],\"description\":\"Multi Package Sub Title\",\"buyType\":\"Network/Custom\"}],\"contentDocumentId\":\"05850000000PJRpAAO\",\"clientContactInformation\":\"Bipin Nepani\\n\\n \\n\\nE   bipin@appirio.com\",\"clientCompanyName\":\"Clear Channel Outdoor\",\"attachmentsUrl\":\"http://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/\",\"appendixes\":[{\"title\":\"00PW0000000XMsLMAW_maps.pdf\",\"showTitle\":true,\"showAppendixEntry\":true,\"salesforceUrl\":\"http://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/00PW0000000XMsLMAW/Body\",\"pathOnClient\":\"00PW0000000XMsLMAW_maps.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"Map\",\"buyType\":null},{\"title\":\"00PW0000000XMsVMAW_maps.pdf\",\"showTitle\":true,\"showAppendixEntry\":true,\"salesforceUrl\":\"http://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/00PW0000000XMsVMAW/Body\",\"pathOnClient\":\"00PW0000000XMsVMAW_maps.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"Map\",\"buyType\":null},{\"title\":\"00PW0000000XMsQMAW_maps.pdf\",\"showTitle\":true,\"showAppendixEntry\":true,\"salesforceUrl\":\"http://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/00PW0000000XMsQMAW/Body\",\"pathOnClient\":\"00PW0000000XMsQMAW_maps.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"Map\",\"buyType\":null}],\"agencyName\":null,\"agencyContactInformation\":null}";

			//multi package plan
			jsonString = "{\"versionNumber\":\"V.004\",\"title\":\"Multi Package Title\",\"subTitle\":\"Multi Package Sub Title\",\"showTotalProgramSummary\":false,\"showTimeAndDateStamp\":true,\"showTableOfContents\":true,\"showPageNumbering\":true,\"showIndividualMarketSummary\":false,\"showIndividualFlightSummary\":false,\"showCoverPage\":true,\"shippingInstructionsUrl\":\"http://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Name%2C+Address1__c%2C+Address2__c%2C+Addressee__c%2C+Attention__c%2C+City__c%2C+Country__c%2C+Division__r.Name%2C+Notes__c%2C+Phone__c%2C+Receiving_Time__c%2C+Sales_Plan__c%2C+State__c%2C+Zip_Code__c+FROM+Plan_Shipping_Instruction__c+WHERE+Sales_Plan__c+%3D+%27a13W0000001CFT0IAO%27\",\"sessionId\":\"00DW00000073REe!ASAAQPzRxBNRuHgWj.7TLjshlKcuInvXqZAh2RWCbXB9Qs3W62Xx3ZE9HXtXvxoywo0vgfItloMHV.bPin.yE4zmWK5SZbeE\",\"packageSummaryUrl\":\"http://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Id%2C+Package_Name__c%2C+Name%2C+Total_Price__c+FROM+Sales_Plan_Package__c+WHERE+Campaign_Sales_Plan__c+%3D+%27a13W0000001CFT0IAO%27\",\"outputFileName\":\"a13W0000001CFT0IAO CPT-Test-test-Oct-2013 - v1\",\"marketName\":null,\"marketContactInformation\":null,\"mapPanelOrderPrefUrl\":\"http://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Sort_Sequence__c%2C+Flight__c%2C+Panel__c+FROM+Map_Panel_Order_Pref__c+WHERE+Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CFT0IAO%27+ORDER+BY+Flight__c%2C+Sort_Sequence__c\",\"insertContentVersionUrl\":\"http://cs13.salesforce.com/services/data/v27.0/sobjects/ContentVersion\",\"exportToXls\":true,\"exportToPdf\":false,\"excludeNetworkDetails\":false,\"excludeFlightLines\":false,\"email\":null,\"disclaimerUrl\":\"http://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT%20Disclaimer__c%2C%20Notes__c%2C%20Sequence__c%2C%20Name%2C%20isShippingInstruction__c%2C%20Media_Types__c%2C%20Additional_Cost_Type__c%2C%20IsAdditionalCostRelated__c%2C%20Division__c%20FROM%20Proposal_Disclaimer__c%20ORDER%20BY%20Sequence__c\",\"dateTimeStamp\":\"11/06/2013 10:14 PM PST\",\"contents\":[{\"title\":\"Multi Package Title\",\"showTitle\":null,\"showAppendixEntry\":true,\"salesforceUrl\":\"http://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c+FROM+Child_Flight_Lines__r%29%2C++Package_Flight__r.Package_Market__r.Package__r.Package_Name__c%2C++Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Id%2C+Package_Flight__r.Package_Market__r.Weekly_Total_18_Imps__c%2C++Package_Flight__r.Package_Market__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.CPM__c%2C+Package_Flight__r.Package_Market__r.CPP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Id%2C+Package_Flight__r.Package_Market__r.Package__r.Weekly_Total_18_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Discount__c%2C+Package_Flight__r.Package_Market__r.Package__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPM__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPP__c%2C++MapLocation_Number__c%2CMedia_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CNetwork_Name__c%2CLocation_Description__c%2CNetwork_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotalMarketImps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CDiscount__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CIllumination_yn__c%2CMax_of_Spots_per_Loop__c%2CHours_of_Operation__c%2CComments__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CProduction__c%2CAdditional_Cost__c%2CTax_Amt__c%2CIn_Mkt_Perc_Comp__c%2CMedia_Product__c%2CRide_Order__c%2CAverage_Daily_Spots__c%2CPackage_Flight__r.Id%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Target_Population__c%2CPackage_Flight__r.Type__c%2C+Id%2C+Package_Flight__r.Media_Category__c+%2C+OB_Summ_Num__c+%2C+Additional_Cost_Type__c++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CFT0IAO%27+ORDER+BY+Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Package__r.Name%2C+Package_Flight__r.Name+\",\"pathOnClient\":\"filea13W0000001CFT0IAO.xml\",\"fieldTypesPipeDelimited\":[\"String&#124;String&#124;Double&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Currency&#124;Currency&#124;Double&#124;Currency&#124;String&#124;String&#124;String&#124;String&#124;String&#124;&#124;&#124;Currency&#124;Currency&#124;Currency&#124;Double&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;Double&#124;String\"],\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":[\"MapLocation_Number__c&#124;Media_Category__c&#124;Number_of_Panels__c&#124;Panel_Id_Label__c&#124;TAB_Id__c&#124;Network_Name__c&#124;Location_Description__c&#124;Network_Description__c&#124;Face_Direction__c&#124;Weekly_Total_18_Imps__c&#124;In_Mkt_Imps__c&#124;TotalMarketImps__c&#124;In_Mkt_TRP__c&#124;PlanTRP__c&#124;Plan_Imps_Reach_Perc__c&#124;Plan_Imps_Avg_Frequency__c&#124;Discount__c&#124;X4_Wk_Proposed_Price__c&#124;Total_Price_0d__c&#124;TotalInMarketCPM_0d__c&#124;CPP_0d__c&#124;Illumination_yn__c&#124;Max_of_Spots_per_Loop__c&#124;Hours_of_Operation__c&#124;Comments__c&#124;Package_Flight__r/Flight_Comments__c&#124;Package_Flight__r/Package_Comments__c&#124;Production__c&#124;Additional_Cost__c&#124;Tax_Amt__c&#124;In_Mkt_Perc_Comp__c&#124;Media_Product__c&#124;Ride_Order__c&#124;Average_Daily_Spots__c&#124;Package_Flight__r/Division__c&#124;Package_Flight__r/Market_Name__c&#124;Package_Flight__r/Package_Name__c&#124;Package_Flight__r/Name&#124;Package_Flight__r/Campaign_Start_Date__c&#124;Package_Flight__r/Campaign_End_Date__c&#124;Package_Flight__r/Duration_And_Type__c&#124;Package_Flight__r/Target__c&#124;Package_Flight__r/Market_Type__c&#124;Package_Flight__r/Target_Population__c&#124;Package_Flight__r/Type__c\"],\"fieldLabelsPipeDelimited\":[\"Map Location #&#124;Media Type&#124;# of Panels&#124;Panel ID&#124;TAB ID&#124;Network Name&#124;Description&#124;Network Description&#124;Face Dir&#124;Weekly Total 18+ Imps&#124;Target In-Market Imps&#124;Target Total Imps&#124;Weekly TRP&#124;Plan TRP&#124;Reach %&#124;Freq&#124;Discount %&#124;4-Wk Proposed Price&#124;Total Price&#124;CPM&#124;CPP&#124;Illum (Y/N)&#124;Max # of Spots per Loop&#124;Hours of Operation&#124;Line Item Comments&#124;Flight Comments&#124;Package Comments&#124;Production&#124;Additional Cost&#124;Tax (Amt)&#124;In Mkt Perc Comp&#124;Media Product&#124;Ride Order&#124;Average Daily Spots&#124;Division&#124;Market Name&#124;Package Name&#124;Flight Name&#124;Start Date&#124;End Date&#124;Duration&#124;Target&#124;Market Type&#124;Target Population&#124;Buy Type\"],\"description\":\"Multi Package Sub Title\",\"buyType\":\"Network/Custom\"}],\"contentDocumentId\":\"05850000000PJRpAAO\",\"clientContactInformation\":\"Bipin Nepani\\n\\n \\n\\nE   bipin@appirio.com\",\"clientCompanyName\":\"Clear Channel Outdoor\",\"attachmentsUrl\":\"http://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/\",\"appendixes\":[{\"title\":\"00PW0000000XMsLMAW_maps.pdf\",\"showTitle\":true,\"showAppendixEntry\":true,\"salesforceUrl\":\"http://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/00PW0000000XMsLMAW/Body\",\"pathOnClient\":\"00PW0000000XMsLMAW_maps.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"Map\",\"buyType\":null},{\"title\":\"00PW0000000XMsVMAW_maps.pdf\",\"showTitle\":true,\"showAppendixEntry\":true,\"salesforceUrl\":\"http://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/00PW0000000XMsVMAW/Body\",\"pathOnClient\":\"00PW0000000XMsVMAW_maps.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"Map\",\"buyType\":null},{\"title\":\"00PW0000000XMsQMAW_maps.pdf\",\"showTitle\":true,\"showAppendixEntry\":true,\"salesforceUrl\":\"http://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/00PW0000000XMsQMAW/Body\",\"pathOnClient\":\"00PW0000000XMsQMAW_maps.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"Map\",\"buyType\":null}],\"agencyName\":null,\"agencyContactInformation\":null}";

			jsonString = "{\"versionNumber\":\"V.004\",\"title\":\"Multi Package Title\",\"subTitle\":\"Multi Package Sub Title\",\"showTotalProgramSummary\":true,\"showTimeAndDateStamp\":true,\"showTableOfContents\":true,\"showPageNumbering\":true,\"showIndividualMarketSummary\":true,\"showIndividualFlightSummary\":true,\"showCoverPage\":true,\"shippingInstructionsUrl\":\"http://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Name%2C+Address1__c%2C+Address2__c%2C+Addressee__c%2C+Attention__c%2C+City__c%2C+Country__c%2C+Division__r.Name%2C+Notes__c%2C+Phone__c%2C+Receiving_Time__c%2C+Sales_Plan__c%2C+State__c%2C+Zip_Code__c+FROM+Plan_Shipping_Instruction__c+WHERE+Sales_Plan__c+%3D+%27a13W0000001CFT0IAO%27\",\"sessionId\":\"00DW00000073REe!ASAAQPzRxBNRuHgWj.7TLjshlKcuInvXqZAh2RWCbXB9Qs3W62Xx3ZE9HXtXvxoywo0vgfItloMHV.bPin.yE4zmWK5SZbeE\",\"packageSummaryUrl\":\"http://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Id%2C+Package_Name__c%2C+Name%2C+Total_Price__c+FROM+Sales_Plan_Package__c+WHERE+Campaign_Sales_Plan__c+%3D+%27a13W0000001CFT0IAO%27\",\"outputFileName\":\"a13W0000001CFT0IAO CPT-Test-test-Oct-2013 - v1\",\"marketName\":null,\"marketContactInformation\":null,\"mapPanelOrderPrefUrl\":\"http://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Sort_Sequence__c%2C+Flight__c%2C+Panel__c+FROM+Map_Panel_Order_Pref__c+WHERE+Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CFT0IAO%27+ORDER+BY+Flight__c%2C+Sort_Sequence__c\",\"insertContentVersionUrl\":\"http://cs13.salesforce.com/services/data/v27.0/sobjects/ContentVersion\",\"exportToXls\":false,\"exportToPdf\":true,\"excludeNetworkDetails\":false,\"excludeFlightLines\":false,\"email\":null,\"disclaimerUrl\":\"http://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT%20Disclaimer__c%2C%20Notes__c%2C%20Sequence__c%2C%20Name%2C%20isShippingInstruction__c%2C%20Media_Types__c%2C%20Additional_Cost_Type__c%2C%20IsAdditionalCostRelated__c%2C%20Division__c%20FROM%20Proposal_Disclaimer__c%20ORDER%20BY%20Sequence__c\",\"dateTimeStamp\":\"11/06/2013 10:14 PM PST\",\"contents\":[{\"title\":\"Multi Package Title\",\"showTitle\":null,\"showAppendixEntry\":true,\"salesforceUrl\":\"http://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c+FROM+Child_Flight_Lines__r%29%2C++Package_Flight__r.Package_Market__r.Package__r.Package_Name__c%2C++Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Id%2C+Package_Flight__r.Package_Market__r.Reach__c%2C+Package_Flight__r.Package_Market__r.Frequency__c%2C+Package_Flight__r.Package_Market__r.Weekly_Total_18_Imps__c%2C++Package_Flight__r.Package_Market__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.CPM__c%2C+Package_Flight__r.Package_Market__r.CPP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Id%2C+Package_Flight__r.Package_Market__r.Package__r.Weekly_Total_18_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Discount__c%2C+Package_Flight__r.Package_Market__r.Package__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPM__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPP__c%2C++MapLocation_Number__c%2CMedia_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CNetwork_Name__c%2CLocation_Description__c%2CNetwork_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotalMarketImps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CDiscount__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CIllumination_yn__c%2CMax_of_Spots_per_Loop__c%2CHours_of_Operation__c%2CComments__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CProduction__c%2CAdditional_Cost__c%2CTax_Amt__c%2CIn_Mkt_Perc_Comp__c%2CMedia_Product__c%2CRide_Order__c%2CAverage_Daily_Spots__c%2CPackage_Flight__r.Id%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Target_Population__c%2CPackage_Flight__r.Type__c%2C+Id%2C+Package_Flight__r.Media_Category__c+%2C+OB_Summ_Num__c+%2C+Additional_Cost_Type__c++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CFT0IAO%27+ORDER+BY+Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Package__r.Name%2C+Package_Flight__r.Name+\",\"pathOnClient\":\"filea13W0000001CFT0IAO.xml\",\"fieldTypesPipeDelimited\":[\"String&#124;String&#124;Double&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Currency&#124;Currency&#124;Double&#124;Currency&#124;String&#124;String&#124;String&#124;String&#124;String&#124;&#124;&#124;Currency&#124;Currency&#124;Currency&#124;Double&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;Double&#124;String\"],\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":[\"MapLocation_Number__c&#124;Media_Category__c&#124;Number_of_Panels__c&#124;Panel_Id_Label__c&#124;TAB_Id__c&#124;Network_Name__c&#124;Location_Description__c&#124;Network_Description__c&#124;Face_Direction__c&#124;Weekly_Total_18_Imps__c&#124;In_Mkt_Imps__c&#124;TotalMarketImps__c&#124;In_Mkt_TRP__c&#124;PlanTRP__c&#124;Plan_Imps_Reach_Perc__c&#124;Plan_Imps_Avg_Frequency__c&#124;Discount__c&#124;X4_Wk_Proposed_Price__c&#124;Total_Price_0d__c&#124;TotalInMarketCPM_0d__c&#124;CPP_0d__c&#124;Illumination_yn__c&#124;Max_of_Spots_per_Loop__c&#124;Hours_of_Operation__c&#124;Comments__c&#124;Package_Flight__r/Flight_Comments__c&#124;Package_Flight__r/Package_Comments__c&#124;Production__c&#124;Additional_Cost__c&#124;Tax_Amt__c&#124;In_Mkt_Perc_Comp__c&#124;Media_Product__c&#124;Ride_Order__c&#124;Average_Daily_Spots__c&#124;Package_Flight__r/Division__c&#124;Package_Flight__r/Market_Name__c&#124;Package_Flight__r/Package_Name__c&#124;Package_Flight__r/Name&#124;Package_Flight__r/Campaign_Start_Date__c&#124;Package_Flight__r/Campaign_End_Date__c&#124;Package_Flight__r/Duration_And_Type__c&#124;Package_Flight__r/Target__c&#124;Package_Flight__r/Market_Type__c&#124;Package_Flight__r/Target_Population__c&#124;Package_Flight__r/Type__c\"],\"fieldLabelsPipeDelimited\":[\"Map Location #&#124;Media Type&#124;# of Panels&#124;Panel ID&#124;TAB ID&#124;Network Name&#124;Description&#124;Network Description&#124;Face Dir&#124;Weekly Total 18+ Imps&#124;Target In-Market Imps&#124;Target Total Imps&#124;Weekly TRP&#124;Plan TRP&#124;Reach %&#124;Freq&#124;Discount %&#124;4-Wk Proposed Price&#124;Total Price&#124;CPM&#124;CPP&#124;Illum (Y/N)&#124;Max # of Spots per Loop&#124;Hours of Operation&#124;Line Item Comments&#124;Flight Comments&#124;Package Comments&#124;Production&#124;Additional Cost&#124;Tax (Amt)&#124;In Mkt Perc Comp&#124;Media Product&#124;Ride Order&#124;Average Daily Spots&#124;Division&#124;Market Name&#124;Package Name&#124;Flight Name&#124;Start Date&#124;End Date&#124;Duration&#124;Target&#124;Market Type&#124;Target Population&#124;Buy Type\"],\"description\":\"Multi Package Sub Title\",\"buyType\":\"Network/Custom\"}],\"contentDocumentId\":\"05850000000PJRpAAO\",\"clientContactInformation\":\"Bipin Nepani\\n\\n \\n\\nE   bipin@appirio.com\",\"clientCompanyName\":\"Clear Channel Outdoor\",\"attachmentsUrl\":\"http://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/\",\"appendixes\":[{\"title\":\"00PW0000000XMsLMAW_maps.pdf\",\"showTitle\":true,\"showAppendixEntry\":true,\"salesforceUrl\":\"http://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/00PW0000000XMsLMAW/Body\",\"pathOnClient\":\"00PW0000000XMsLMAW_maps.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"Map\",\"buyType\":null},{\"title\":\"00PW0000000XMsVMAW_maps.pdf\",\"showTitle\":true,\"showAppendixEntry\":true,\"salesforceUrl\":\"http://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/00PW0000000XMsVMAW/Body\",\"pathOnClient\":\"00PW0000000XMsVMAW_maps.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"Map\",\"buyType\":null},{\"title\":\"00PW0000000XMsQMAW_maps.pdf\",\"showTitle\":true,\"showAppendixEntry\":true,\"salesforceUrl\":\"http://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/00PW0000000XMsQMAW/Body\",\"pathOnClient\":\"00PW0000000XMsQMAW_maps.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"Map\",\"buyType\":null}],\"agencyName\":null,\"agencyContactInformation\":null}";

			
			
			//infinite loop error plan
			//jsonString = "{\"versionNumber\":\"V.022\",\"title\":\"Million Dolllar Dea\",\"subTitle\":\"test override\",\"showTotalProgramSummary\":true,\"showTimeAndDateStamp\":false,\"showTableOfContents\":false,\"showPageNumbering\":false,\"showIndividualMarketSummary\":false,\"showIndividualFlightSummary\":false,\"showCoverPage\":true,\"shippingInstructionsUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Name%2C+Address1__c%2C+Address2__c%2C+Addressee__c%2C+Attention__c%2C+City__c%2C+Country__c%2C+Division__r.Name%2C+Notes__c%2C+Phone__c%2C+Receiving_Time__c%2C+Sales_Plan__c%2C+State__c%2C+Zip_Code__c+FROM+Plan_Shipping_Instruction__c+WHERE+Sales_Plan__c+%3D+%27a13W0000001CQhIIAW%27\",\"sessionId\":\"00DW00000073REe!ASAAQDTvxWrPkNNxQXLVYGhPkUVF8uZMCbVwE.gXXTcNO7rR1H5Ip2.Z50GidDuCXL3sj.aoarqzERwpq6Pv.11mR4Agby6p\",\"packageSummaryUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Id%2C+Package_Name__c%2C+Name%2C+Total_Price__c+FROM+Sales_Plan_Package__c+WHERE+Campaign_Sales_Plan__c+%3D+%27a13W0000001CQhIIAW%27\",\"outputFileName\":\"a13W0000001CQhIIAW QTE-SCP-11/5/2013\",\"marketName\":null,\"marketContactInformation\":null,\"mapPanelOrderPrefUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+Sort_Sequence__c%2C+Flight__c%2C+Panel__c+FROM+Map_Panel_Order_Pref__c+WHERE+Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CQhIIAW%27+ORDER+BY+Flight__c%2C+Sort_Sequence__c\",\"insertContentVersionUrl\":\"https://cs13.salesforce.com/services/data/v27.0/sobjects/ContentVersion\",\"exportToXls\":false,\"exportToPdf\":true,\"excludeNetworkDetails\":false,\"excludeFlightLines\":false,\"email\":null,\"disclaimerUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT%20Disclaimer__c%2C%20Notes__c%2C%20Sequence__c%2C%20Name%2C%20isShippingInstruction__c%2C%20Media_Types__c%2C%20Additional_Cost_Type__c%2C%20IsAdditionalCostRelated__c%2C%20Division__c%20FROM%20Proposal_Disclaimer__c%20ORDER%20BY%20Sequence__c\",\"dateTimeStamp\":\"11/11/2013 02:44 AM EST\",\"contents\":[{\"title\":\"Million Dolllar Dea\",\"showTitle\":null,\"showAppendixEntry\":true,\"salesforceUrl\":\"https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Unit_Size__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c%2CIn_Mkt_Perc_Comp__c+FROM+Child_Flight_Lines__r%29%2C++Package_Flight__r.Package_Market__r.Package__r.Package_Name__c%2C++Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Id%2C+Package_Flight__r.Package_Market__r.Weekly_Total_18_Imps__c%2C++Package_Flight__r.Package_Market__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.CPM__c%2C+Package_Flight__r.Package_Market__r.CPP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Id%2C+Package_Flight__r.Package_Market__r.Package__r.Weekly_Total_18_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Discount__c%2C+Package_Flight__r.Package_Market__r.Package__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPM__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPP__c%2C++MapLocation_Number__c%2CMedia_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CNetwork_Name__c%2CLocation_Description__c%2CNetwork_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotalMarketImps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CDiscount__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CUnit_Size__c%2CIllumination_yn__c%2CMax_of_Spots_per_Loop__c%2CHours_of_Operation__c%2CComments__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CPackage_Flight__r.Id%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2C+Package_Flight__r.Type__c+%2C+Id%2C+Package_Flight__r.Media_Category__c+%2C+OB_Summ_Num__c+%2C+Additional_Cost_Type__c++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CQhIIAW%27+ORDER+BY+Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Package__r.Name%2C+Package_Flight__r.Name+\",\"pathOnClient\":\"filea13W0000001CQhIIAW.xml\",\"fieldTypesPipeDelimited\":[\"String&#124;String&#124;Double&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Double&#124;Currency&#124;Currency&#124;Double&#124;Currency&#124;String&#124;String&#124;String&#124;String&#124;String&#124;&#124;&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String&#124;String\"],\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":[\"MapLocation_Number__c&#124;Media_Category__c&#124;Number_of_Panels__c&#124;Panel_Id_Label__c&#124;TAB_Id__c&#124;Network_Name__c&#124;Location_Description__c&#124;Network_Description__c&#124;Face_Direction__c&#124;Weekly_Total_18_Imps__c&#124;In_Mkt_Imps__c&#124;TotalMarketImps__c&#124;In_Mkt_TRP__c&#124;PlanTRP__c&#124;Plan_Imps_Reach_Perc__c&#124;Plan_Imps_Avg_Frequency__c&#124;Discount__c&#124;X4_Wk_Proposed_Price__c&#124;Total_Price_0d__c&#124;TotalInMarketCPM_0d__c&#124;CPP_0d__c&#124;Unit_Size__c&#124;Illumination_yn__c&#124;Max_of_Spots_per_Loop__c&#124;Hours_of_Operation__c&#124;Comments__c&#124;Package_Flight__r/Flight_Comments__c&#124;Package_Flight__r/Package_Comments__c&#124;Package_Flight__r/Division__c&#124;Package_Flight__r/Market_Name__c&#124;Package_Flight__r/Package_Name__c&#124;Package_Flight__r/Name&#124;Package_Flight__r/Campaign_Start_Date__c&#124;Package_Flight__r/Campaign_End_Date__c&#124;Package_Flight__r/Duration_And_Type__c&#124;Package_Flight__r/Target__c\"],\"fieldLabelsPipeDelimited\":[\"Map Location #&#124;Media Type&#124;# of Panels&#124;Panel ID&#124;TAB ID&#124;Network Name&#124;Description&#124;Network Description&#124;Face Dir&#124;Weekly Total 18+ Imps&#124;Target In-Market Imps&#124;Target Total Imps&#124;Weekly TRP&#124;Plan TRP&#124;Reach %&#124;Freq&#124;Discount %&#124;4-Wk Proposed Price&#124;Total Price&#124;CPM&#124;CPP&#124;Unit Size* (HxW)&#124;Illum (Y/N)&#124;Max # of Spots per Loop&#124;Hours of Operation&#124;Line Item Comments&#124;Flight Comments&#124;Package Comments&#124;Division&#124;Market Name&#124;Package Name&#124;Flight Name&#124;Start Date&#124;End Date&#124;Duration&#124;Target\"],\"description\":\"test override\",\"buyType\":\"Location\"}],\"contentDocumentId\":\"05850000000PJRpAAO\",\"clientContactInformation\":\"Martina Schmidt\\n99 Park Ave, 2 Fl\\nNew York, NY 10017\\nP   212-812-0068\\nE   martinaschmidt@clearchannel.com\",\"clientCompanyName\":\"Clear Channel Outdoor\",\"attachmentsUrl\":\"https://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/\",\"appendixes\":[{\"title\":\"00PW0000000XPv8MAG_maps.pdf\",\"showTitle\":true,\"showAppendixEntry\":true,\"salesforceUrl\":\"https://cs13.salesforce.com/services/data/v27.0/sobjects/Attachment/00PW0000000XPv8MAG/Body\",\"pathOnClient\":\"00PW0000000XPv8MAG_maps.pdf\",\"fieldTypesPipeDelimited\":null,\"fieldTotalsPipeDelimited\":null,\"fieldNamesPipeDelimited\":null,\"fieldLabelsPipeDelimited\":null,\"description\":\"$100M Question\",\"buyType\":null}],\"agencyName\":null,\"agencyContactInformation\":null}";
			
			PDFCombinerArguments pdfCombinerArguments = new ObjectMapper().readValue(jsonString, PDFCombinerArguments.class);

			System.out.println(" pdfCombinerArguments ->" + pdfCombinerArguments.getContents() + " getDisclaimerUrl " + pdfCombinerArguments.getDisclaimerUrl());

			System.out.println(" [x] Message received");

			// download disclaimer
			String disclaimerXmlFilename = "c:/tmp/disclaimers.xml";
			downloadFile(pdfCombinerArguments.getDisclaimerUrl(), sessionId, disclaimerXmlFilename);

			// download shipping instructions
			String shippingInstructionsXmlFilename = null;
			if(pdfCombinerArguments.isExportToPdf()) {
				shippingInstructionsXmlFilename = "c:/tmp/shippingInstructions" + uniqueId + ".xml";
				downloadFile(pdfCombinerArguments.getShippingInstructionsUrl(), sessionId, shippingInstructionsXmlFilename);
			}

			//download package summary file
			String packageSummaryXmlFilename = "c:/tmp/packageSummary" + uniqueId + ".xml";
			downloadFile(pdfCombinerArguments.getPackageSummaryUrl(), sessionId, packageSummaryXmlFilename);

			// download map panel order preferences
			String mapPanelOrderPrefXmlFilename = "c:/tmp/mapPanelOrderPref" + uniqueId + ".xml";
			downloadFile(pdfCombinerArguments.getMapPanelOrderPrefUrl(), sessionId, mapPanelOrderPrefXmlFilename);


			// if has contents...
			if(pdfCombinerArguments.getContents() != null) {

				// iterate over contents
				Iterator<PDFCombinerFile> it = pdfCombinerArguments.getContents().iterator();
				// while iterator has elements
				while (it.hasNext()) {

					// get next file
					PDFCombinerFile file = it.next();
					System.out.println(" PDFCombinerFile file " +file.getPathOnClient() );
					// format file name
					String fileName = "c:/tmp/" + file.getPathOnClient();

					String	mySalesForceURL ="";
					//location buy type
					//pdf
					mySalesForceURL="https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Unit_Size__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c+FROM+Child_Flight_Lines__r%29%2C++MapLocation_Number__c%2CMedia_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CNetwork_Name__c%2CLocation_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotal_Imps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CUnit_Size__c%2CIllumination_yn__c%2CHours_of_Operation__c%2CComments__c%2CNetwork_Description__c%2CTiming__c%2CWeeklyMarketImps__c%2CWeeklyInMarketImps__c%2CMedia_Product__c%2CRide_Order__c%2CX4_Wk_Base_Rate__c%2CX4_Wk_Floor__c%2CNetwork_Notes__c%2CAverage_Daily_Spots__c%2CFacing__c%2CIn_Mkt_Perc_Comp__c%2CPackage_Flight__r.Id%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Target_Population__c%2CPackage_Flight__r.Type__c%2C+Id%2C+Package_Flight__r.Media_Category__c++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a0u50000000ZrRlAAK%27+ORDER+BY+Package_Flight__r.Name+";
					//xls
					mySalesForceURL="https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Unit_Size__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c+FROM+Child_Flight_Lines__r%29%2C++X4_Wk_Base_Rate__c%2CX4_Wk_Floor__c%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2CMapLocation_Number__c%2CMedia_Category__c%2CPackage_Flight__r.Media_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CNetwork_Name__c%2CLocation_Description__c%2CNetwork_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotal_Imps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CUnit_Size__c%2CIllumination_yn__c%2CMax_of_Spots_per_Loop__c%2CHours_of_Operation__c%2CComments__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CPackage_Flight__r.Target_Population__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Type__c%2CFacing__c%2CNetwork_Notes__c%2CTiming__c%2CWeekly_Total_18_Imps_000__c%2CWeeklyMarketImps__c%2CWeekly_Total_Target_Imps_000__c%2CWeeklyInMarketImps__c%2CWeekly_In_Market_Target_Imps_000__c%2CTarget_In_Market_Imps_000__c%2CTarget_Total_Imps_000__c%2CIn_Mkt_Perc_Comp__c%2CX4_Wk_Avg_Rate_per_Panel__c%2CNet_Amount_Value__c%2CProduction__c%2CAdditional_Cost__c%2CTax_Amt__c%2CLocation_Longitude__c%2CLocation_Latitude__c%2CAverage_Daily_Spots__c%2CEmbellishments__c%2CIllumination__c%2CCurrent_Copy__c%2CCity__c%2CCounty__c%2CState__c%2CZip__c%2CMedia_Product__c%2CRide_Order__c%2CPackage_Flight__r.Target_Population__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Type__c%2CFacing__c%2CNetwork_Notes__c%2CTiming__c%2CWeekly_Total_18_Imps_000__c%2CWeeklyMarketImps__c%2CWeekly_Total_Target_Imps_000__c%2CWeeklyInMarketImps__c%2CWeekly_In_Market_Target_Imps_000__c%2CTarget_In_Market_Imps_000__c%2CTarget_Total_Imps_000__c%2CIn_Mkt_Perc_Comp__c%2CX4_Wk_Avg_Rate_per_Panel__c%2CNet_Amount_Value__c%2CProduction__c%2CAdditional_Cost__c%2CTax_Amt__c%2CLocation_Longitude__c%2CLocation_Latitude__c%2CAverage_Daily_Spots__c%2CEmbellishments__c%2CIllumination__c%2CCurrent_Copy__c%2CCity__c%2CCounty__c%2CState__c%2CZip__c%2CMedia_Product__c%2CRide_Order__c%2C+Id%2C+Package_Flight__r.Id++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a0u50000000ZrRlAAK%27+ORDER+BY+Package_Flight__r.Name+";

					//network buy type
					//pdf
					mySalesForceURL="https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Unit_Size__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c+FROM+Child_Flight_Lines__r%29%2C++MapLocation_Number__c%2CMedia_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CNetwork_Name__c%2CLocation_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotal_Imps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CUnit_Size__c%2CIllumination_yn__c%2CHours_of_Operation__c%2CComments__c%2CNetwork_Description__c%2CTiming__c%2CWeeklyMarketImps__c%2CWeeklyInMarketImps__c%2CMedia_Product__c%2CRide_Order__c%2CX4_Wk_Base_Rate__c%2CX4_Wk_Floor__c%2CNetwork_Notes__c%2CAverage_Daily_Spots__c%2CFacing__c%2CIn_Mkt_Perc_Comp__c%2CPackage_Flight__r.Id%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Target_Population__c%2CPackage_Flight__r.Type__c%2C+Id%2C+Package_Flight__r.Media_Category__c++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a0u50000000ZrRqAAK%27+ORDER+BY+Package_Flight__r.Name+";
					//xls
					mySalesForceURL="https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Unit_Size__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c+FROM+Child_Flight_Lines__r%29%2C++X4_Wk_Base_Rate__c%2CX4_Wk_Floor__c%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2CMapLocation_Number__c%2CMedia_Category__c%2CPackage_Flight__r.Media_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CNetwork_Name__c%2CLocation_Description__c%2CNetwork_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotal_Imps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CUnit_Size__c%2CIllumination_yn__c%2CMax_of_Spots_per_Loop__c%2CHours_of_Operation__c%2CComments__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CPackage_Flight__r.Target_Population__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Type__c%2CFacing__c%2CNetwork_Notes__c%2CTiming__c%2CWeekly_Total_18_Imps_000__c%2CWeeklyMarketImps__c%2CWeekly_Total_Target_Imps_000__c%2CWeeklyInMarketImps__c%2CWeekly_In_Market_Target_Imps_000__c%2CTarget_In_Market_Imps_000__c%2CTarget_Total_Imps_000__c%2CIn_Mkt_Perc_Comp__c%2CX4_Wk_Avg_Rate_per_Panel__c%2CNet_Amount_Value__c%2CProduction__c%2CAdditional_Cost__c%2CTax_Amt__c%2CLocation_Longitude__c%2CLocation_Latitude__c%2CAverage_Daily_Spots__c%2CEmbellishments__c%2CIllumination__c%2CCurrent_Copy__c%2CCity__c%2CCounty__c%2CState__c%2CZip__c%2CMedia_Product__c%2CRide_Order__c%2C+Id%2C+Package_Flight__r.Id++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a0u50000000ZrRqAAK%27+ORDER+BY+Package_Flight__r.Name+";

					//audience buy type
					//pdf
					mySalesForceURL = "https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Unit_Size__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c+FROM+Child_Flight_Lines__r%29%2C++MapLocation_Number__c%2CMedia_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CNetwork_Name__c%2CLocation_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotal_Imps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CUnit_Size__c%2CIllumination_yn__c%2CHours_of_Operation__c%2CComments__c%2CNetwork_Description__c%2CTiming__c%2CWeeklyMarketImps__c%2CWeeklyInMarketImps__c%2CMedia_Product__c%2CRide_Order__c%2CX4_Wk_Base_Rate__c%2CX4_Wk_Floor__c%2CNetwork_Notes__c%2CAverage_Daily_Spots__c%2CFacing__c%2CIn_Mkt_Perc_Comp__c%2CPackage_Flight__r.Id%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Target_Population__c%2CPackage_Flight__r.Type__c%2C+Id%2C+Package_Flight__r.Media_Category__c++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a0u50000000ZrfnAAC%27+ORDER+BY+Package_Flight__r.Name+";
					//xls
					mySalesForceURL = "https://na3.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Unit_Size__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c+FROM+Child_Flight_Lines__r%29%2C++X4_Wk_Base_Rate__c%2CX4_Wk_Floor__c%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2CMapLocation_Number__c%2CMedia_Category__c%2CPackage_Flight__r.Media_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CNetwork_Name__c%2CLocation_Description__c%2CNetwork_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotal_Imps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CUnit_Size__c%2CIllumination_yn__c%2CMax_of_Spots_per_Loop__c%2CHours_of_Operation__c%2CComments__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CPackage_Flight__r.Target_Population__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Type__c%2CFacing__c%2CNetwork_Notes__c%2CTiming__c%2CWeekly_Total_18_Imps_000__c%2CWeeklyMarketImps__c%2CWeekly_Total_Target_Imps_000__c%2CWeeklyInMarketImps__c%2CWeekly_In_Market_Target_Imps_000__c%2CTarget_In_Market_Imps_000__c%2CTarget_Total_Imps_000__c%2CIn_Mkt_Perc_Comp__c%2CX4_Wk_Avg_Rate_per_Panel__c%2CNet_Amount_Value__c%2CProduction__c%2CAdditional_Cost__c%2CTax_Amt__c%2CLocation_Longitude__c%2CLocation_Latitude__c%2CAverage_Daily_Spots__c%2CEmbellishments__c%2CIllumination__c%2CCurrent_Copy__c%2CCity__c%2CCounty__c%2CState__c%2CZip__c%2CMedia_Product__c%2CRide_Order__c%2C+Id%2C+Package_Flight__r.Id++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a0u50000000ZrfnAAC%27+ORDER+BY+Package_Flight__r.Name+";

					//multi buy type plan
					//pdf
					mySalesForceURL = "https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Unit_Size__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c+FROM+Child_Flight_Lines__r%29%2C++Package_Flight__r.Package_Market__r.Package__r.Package_Name__c%2C++Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Id%2C+Package_Flight__r.Package_Market__r.Weekly_Total_18_Imps__c%2C++Package_Flight__r.Package_Market__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.CPM__c%2C+Package_Flight__r.Package_Market__r.CPP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Id%2C+Package_Flight__r.Package_Market__r.Package__r.Weekly_Total_18_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Discount__c%2C+Package_Flight__r.Package_Market__r.Package__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPM__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPP__c%2C++MapLocation_Number__c%2CMedia_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CNetwork_Name__c%2CLocation_Description__c%2CNetwork_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotal_Imps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CDiscount__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CUnit_Size__c%2CIllumination_yn__c%2CHours_of_Operation__c%2CComments__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CFacing__c%2CNetwork_Notes__c%2CTiming__c%2CMedia_Product__c%2CRide_Order__c%2CAverage_Daily_Spots__c%2CProduction__c%2CAdditional_Cost__c%2CAdditional_Cost_Type__c%2CPackage_Flight__r.Id%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Target_Population__c%2CPackage_Flight__r.Type__c%2C+Id%2C+Package_Flight__r.Media_Category__c+%2C+OB_Summ_Num__c++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CFT0IAO%27+ORDER+BY+Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Package__r.Name%2C+Package_Flight__r.Name+";
					//xls
					//mySalesForceURL = "https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Unit_Size__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c+FROM+Child_Flight_Lines__r%29%2C++Package_Flight__r.Package_Market__r.Package__r.Package_Name__c%2C++Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Id%2C+Package_Flight__r.Package_Market__r.Weekly_Total_18_Imps__c%2C++Package_Flight__r.Package_Market__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.CPM__c%2C+Package_Flight__r.Package_Market__r.CPP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Id%2C+Package_Flight__r.Package_Market__r.Package__r.Weekly_Total_18_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Discount__c%2C+Package_Flight__r.Package_Market__r.Package__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPM__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPP__c%2C++X4_Wk_Base_Rate__c%2CX4_Wk_Floor__c%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2CMapLocation_Number__c%2CMedia_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CNetwork_Name__c%2CLocation_Description__c%2CNetwork_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotal_Imps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CDiscount__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CUnit_Size__c%2CIllumination_yn__c%2CHours_of_Operation__c%2CComments__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Target_Population__c%2CPackage_Flight__r.Type__c%2CFacing__c%2CNetwork_Notes__c%2CTiming__c%2CWeekly_Total_18_Imps_000__c%2CWeeklyMarketImps__c%2CWeekly_Total_Target_Imps_000__c%2CWeeklyInMarketImps__c%2CWeekly_In_Market_Target_Imps_000__c%2CTarget_In_Market_Imps_000__c%2CTarget_Total_Imps_000__c%2CIn_Mkt_Perc_Comp__c%2CX4_Wk_Avg_Rate_per_Panel__c%2CNet_Amount_Value__c%2CProduction__c%2CAdditional_Cost__c%2CTax_Amt__c%2CLocation_Longitude__c%2CLocation_Latitude__c%2CMax_of_Spots_per_Loop__c%2CAverage_Daily_Spots__c%2CEmbellishments__c%2CIllumination__c%2CCurrent_Copy__c%2CCity__c%2CCounty__c%2CState__c%2CZip__c%2CMedia_Product__c%2CRide_Order__c%2C+Id%2C+Package_Flight__r.Id+%2C+Package_Flight__r.Media_Category__c+%2C+OB_Summ_Num__c++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CFT0IAO%27+ORDER+BY+Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Package__r.Name%2C+Package_Flight__r.Name+";

					//mySalesForceURL = "https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Unit_Size__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c+FROM+Child_Flight_Lines__r%29%2C++Package_Flight__r.Package_Market__r.Package__r.Package_Name__c%2C++Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Id%2C+Package_Flight__r.Package_Market__r.Weekly_Total_18_Imps__c%2C++Package_Flight__r.Package_Market__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.CPM__c%2C+Package_Flight__r.Package_Market__r.CPP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Id%2C+Package_Flight__r.Package_Market__r.Package__r.Weekly_Total_18_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Discount__c%2C+Package_Flight__r.Package_Market__r.Package__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPM__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPP__c%2C++MapLocation_Number__c%2CMedia_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CLocation_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotal_Imps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CDiscount__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CUnit_Size__c%2CIllumination_yn__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CComments__c%2CPackage_Flight__r.Id%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2CPackage_Flight__r.Type__c%2C+Id%2C+Package_Flight__r.Media_Category__c+%2C+OB_Summ_Num__c+%2C+Additional_Cost_Type__c++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CPIxIAO%27+ORDER+BY+Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Package__r.Name%2C+Package_Flight__r.Name+";

					mySalesForceURL = "https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Unit_Size__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c+FROM+Child_Flight_Lines__r%29%2C++Package_Flight__r.Package_Market__r.Package__r.Package_Name__c%2C++Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Id%2C+Package_Flight__r.Package_Market__r.Weekly_Total_18_Imps__c%2C++Package_Flight__r.Package_Market__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.CPM__c%2C+Package_Flight__r.Package_Market__r.CPP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Id%2C+Package_Flight__r.Package_Market__r.Package__r.Weekly_Total_18_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Discount__c%2C+Package_Flight__r.Package_Market__r.Package__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPM__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPP__c%2C++MapLocation_Number__c%2CMedia_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CNetwork_Name__c%2CLocation_Description__c%2CNetwork_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotal_Imps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CDiscount__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CUnit_Size__c%2CIllumination_yn__c%2CHours_of_Operation__c%2CComments__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CFacing__c%2CNetwork_Notes__c%2CTiming__c%2CMedia_Product__c%2CRide_Order__c%2CAverage_Daily_Spots__c%2CProduction__c%2CAdditional_Cost__c%2CAdditional_Cost_Type__c%2CPackage_Flight__r.Id%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Target_Population__c%2CPackage_Flight__r.Type__c%2C+Id%2C+Package_Flight__r.Media_Category__c+%2C+OB_Summ_Num__c++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CRqPIAW%27+ORDER+BY+Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Package__r.Name%2C+Package_Flight__r.Name+";
					
					mySalesForceURL = "https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Unit_Size__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c+FROM+Child_Flight_Lines__r%29%2C++Package_Flight__r.Package_Market__r.Package__r.Package_Name__c%2C++Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Id%2C+Package_Flight__r.Package_Market__r.Weekly_Total_18_Imps__c%2C++Package_Flight__r.Package_Market__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.CPM__c%2C+Package_Flight__r.Package_Market__r.CPP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Id%2C+Package_Flight__r.Package_Market__r.Package__r.Weekly_Total_18_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Discount__c%2C+Package_Flight__r.Package_Market__r.Package__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPM__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPP__c%2C++MapLocation_Number__c%2CMedia_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CLocation_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotalMarketImps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CIllumination_yn__c%2CComments__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CAdditional_Cost__c%2CPackage_Flight__r.Id%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2C+Package_Flight__r.Type__c+%2C+Id%2C+Package_Flight__r.Media_Category__c+%2C+OB_Summ_Num__c+%2C+Additional_Cost_Type__c++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CRq5IAG%27+ORDER+BY+Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Package__r.Name%2C+Package_Flight__r.Name+";
					
					//network
					mySalesForceURL = "https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Unit_Size__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c+FROM+Child_Flight_Lines__r%29%2C++Package_Flight__r.Package_Market__r.Package__r.Package_Name__c%2C++Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Id%2C+Package_Flight__r.Package_Market__r.Weekly_Total_18_Imps__c%2C++Package_Flight__r.Package_Market__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.CPM__c%2C+Package_Flight__r.Package_Market__r.CPP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Id%2C+Package_Flight__r.Package_Market__r.Package__r.Weekly_Total_18_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Discount__c%2C+Package_Flight__r.Package_Market__r.Package__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPM__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPP__c%2C++MapLocation_Number__c%2CMedia_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CLocation_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotalMarketImps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CIllumination_yn__c%2CComments__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CAdditional_Cost__c%2CPackage_Flight__r.Id%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2C+Package_Flight__r.Type__c+%2C+Id%2C+Package_Flight__r.Media_Category__c+%2C+OB_Summ_Num__c+%2C+Additional_Cost_Type__c++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CRpgIAG%27+ORDER+BY+Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Package__r.Name%2C+Package_Flight__r.Name+";
					
	
					mySalesForceURL = "https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Unit_Size__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c%2C+In_Mkt_Perc_Comp__c+FROM+Child_Flight_Lines__r%29%2C++Package_Flight__r.Package_Market__r.Package__r.Package_Name__c%2C++Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Id%2C+Package_Flight__r.Package_Market__r.Weekly_Total_18_Imps__c%2C++Package_Flight__r.Package_Market__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.CPM__c%2C+Package_Flight__r.Package_Market__r.CPP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Id%2C+Package_Flight__r.Package_Market__r.Package__r.Weekly_Total_18_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Discount__c%2C+Package_Flight__r.Package_Market__r.Package__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPM__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPP__c%2C++MapLocation_Number__c%2CMedia_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CNetwork_Name__c%2CLocation_Description__c%2CNetwork_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotalMarketImps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CDiscount__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CUnit_Size__c%2CIllumination_yn__c%2CMax_of_Spots_per_Loop__c%2CHours_of_Operation__c%2CComments__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CIn_Mkt_Perc_Comp__c%2CAdditional_Cost__c%2CPackage_Flight__r.Id%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2C+Package_Flight__r.Type__c+%2C+Id%2C+Package_Flight__r.Media_Category__c+%2C+OB_Summ_Num__c+%2C+Additional_Cost_Type__c++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CRpgIAG%27+ORDER+BY+Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Package__r.Name%2C+Package_Flight__r.Name+";
					
					//multi buy type plan
					//pdf
					mySalesForceURL = "http://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c+FROM+Child_Flight_Lines__r%29%2C++Package_Flight__r.Package_Market__r.Package__r.Package_Name__c%2C++Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Id%2C+Package_Flight__r.Package_Market__r.Weekly_Total_18_Imps__c%2C++Package_Flight__r.Package_Market__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.CPM__c%2C+Package_Flight__r.Package_Market__r.CPP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Id%2C+Package_Flight__r.Package_Market__r.Package__r.Weekly_Total_18_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Discount__c%2C+Package_Flight__r.Package_Market__r.Package__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPM__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPP__c%2C++MapLocation_Number__c%2CMedia_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CNetwork_Name__c%2CLocation_Description__c%2CNetwork_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotalMarketImps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CDiscount__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CIllumination_yn__c%2CMax_of_Spots_per_Loop__c%2CHours_of_Operation__c%2CComments__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CProduction__c%2CAdditional_Cost__c%2CTax_Amt__c%2CIn_Mkt_Perc_Comp__c%2CMedia_Product__c%2CRide_Order__c%2CAverage_Daily_Spots__c%2CPackage_Flight__r.Id%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Target_Population__c%2CPackage_Flight__r.Type__c%2C+Id%2C+Package_Flight__r.Media_Category__c+%2C+OB_Summ_Num__c+%2C+Additional_Cost_Type__c++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CFT0IAO%27+ORDER+BY+Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Package__r.Name%2C+Package_Flight__r.Name+";
				
					mySalesForceURL = "http://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c+FROM+Child_Flight_Lines__r%29%2C++Package_Flight__r.Package_Market__r.Package__r.Package_Name__c%2C++Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Id%2C+Package_Flight__r.Package_Market__r.Reach__c%2C+Package_Flight__r.Package_Market__r.Frequency__c%2C+Package_Flight__r.Package_Market__r.Weekly_Total_18_Imps__c%2C++Package_Flight__r.Package_Market__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.CPM__c%2C+Package_Flight__r.Package_Market__r.CPP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Id%2C+Package_Flight__r.Package_Market__r.Package__r.Weekly_Total_18_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Discount__c%2C+Package_Flight__r.Package_Market__r.Package__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPM__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPP__c%2C++MapLocation_Number__c%2CMedia_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CNetwork_Name__c%2CLocation_Description__c%2CNetwork_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotalMarketImps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CDiscount__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CIllumination_yn__c%2CMax_of_Spots_per_Loop__c%2CHours_of_Operation__c%2CComments__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CProduction__c%2CAdditional_Cost__c%2CTax_Amt__c%2CIn_Mkt_Perc_Comp__c%2CMedia_Product__c%2CRide_Order__c%2CAverage_Daily_Spots__c%2CPackage_Flight__r.Id%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2CPackage_Flight__r.Market_Type__c%2CPackage_Flight__r.Target_Population__c%2CPackage_Flight__r.Type__c%2C+Id%2C+Package_Flight__r.Media_Category__c+%2C+OB_Summ_Num__c+%2C+Additional_Cost_Type__c++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CFT0IAO%27+ORDER+BY+Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Package__r.Name%2C+Package_Flight__r.Name+";
					
					//infinite loop error plan
	//				mySalesForceURL = "https://cs13.salesforce.com/services/data/v27.0/query/?q=SELECT+RecordTypeId%2C++%28SELECT+RecordTypeId%2C+Parent_Flight_Line__c%2C+Network_Name__c%2C+MapLocation_Number__c%2C+MarketName__c%2C+Location_Description__c%2C+Panel_Id_Label__c%2C+TAB_Id__c%2C+Face_Direction__c%2C+Unit_Size__c%2C+Weekly_Total_18_Imps__c%2C+In_Mkt_Imps__c%2C+Total_Imps__c%2C+In_Mkt_TRP__c%2C+PlanTRP__c%2C+Plan_Imps_Reach_Perc__c%2C+Plan_Imps_Avg_Frequency__c%2CIn_Mkt_Perc_Comp__c+FROM+Child_Flight_Lines__r%29%2C++Package_Flight__r.Package_Market__r.Package__r.Package_Name__c%2C++Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Id%2C+Package_Flight__r.Package_Market__r.Weekly_Total_18_Imps__c%2C++Package_Flight__r.Package_Market__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.CPM__c%2C+Package_Flight__r.Package_Market__r.CPP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Id%2C+Package_Flight__r.Package_Market__r.Package__r.Weekly_Total_18_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.Target_Total_Imps__c%2C+Package_Flight__r.Package_Market__r.Package__r.In_Mkt_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Plan_TRP__c%2C+Package_Flight__r.Package_Market__r.Package__r.Discount__c%2C+Package_Flight__r.Package_Market__r.Package__r.Total_Price__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPM__c%2C+Package_Flight__r.Package_Market__r.Package__r.CPP__c%2C++MapLocation_Number__c%2CMedia_Category__c%2CNumber_of_Panels__c%2CPanel_Id_Label__c%2CTAB_Id__c%2CNetwork_Name__c%2CLocation_Description__c%2CNetwork_Description__c%2CFace_Direction__c%2CWeekly_Total_18_Imps__c%2CIn_Mkt_Imps__c%2CTotalMarketImps__c%2CIn_Mkt_TRP__c%2CPlanTRP__c%2CPlan_Imps_Reach_Perc__c%2CPlan_Imps_Avg_Frequency__c%2CDiscount__c%2CX4_Wk_Proposed_Price__c%2CTotal_Price_0d__c%2CTotalInMarketCPM_0d__c%2CCPP_0d__c%2CUnit_Size__c%2CIllumination_yn__c%2CMax_of_Spots_per_Loop__c%2CHours_of_Operation__c%2CComments__c%2CPackage_Flight__r.Flight_Comments__c%2CPackage_Flight__r.Package_Comments__c%2CPackage_Flight__r.Id%2CPackage_Flight__r.Division__c%2CPackage_Flight__r.Market_Name__c%2CPackage_Flight__r.Package_Name__c%2CPackage_Flight__r.Name%2CPackage_Flight__r.Campaign_Start_Date__c%2CPackage_Flight__r.Campaign_End_Date__c%2CPackage_Flight__r.Duration_And_Type__c%2CPackage_Flight__r.Target__c%2C+Package_Flight__r.Type__c+%2C+Id%2C+Package_Flight__r.Media_Category__c+%2C+OB_Summ_Num__c+%2C+Additional_Cost_Type__c++FROM+Package_Flight_Line__c++WHERE+Parent_Flight_Line__c+%3D+null+AND+Package_Flight__r.Package_Market__r.Package__r.Campaign_Sales_Plan__r.Id+%3D+%27a13W0000001CQhIIAW%27+ORDER+BY+Package_Flight__r.Package_Market__r.MarketName__c%2C+Package_Flight__r.Package_Market__r.Package__r.Name%2C+Package_Flight__r.Name+";
					
					downloadFile(mySalesForceURL, sessionId, fileName);

					try {
						if(fileName.endsWith(".xml")) {
							Reporter reporter = null;
							if(pdfCombinerArguments.isExportToPdf()) {
								reporter = new PdfReporter(fileName,
										disclaimerXmlFilename,
										mapPanelOrderPrefXmlFilename,
										shippingInstructionsXmlFilename,
										pdfCombinerArguments.isExcludeNetworkDetails(),
										pdfCombinerArguments.isShowTotalProgramSummary(),
										pdfCombinerArguments.isShowIndividualMarketSummary(),
										pdfCombinerArguments.isShowIndividualFlightSummary(),
										file, pdfCombinerArguments.getAppendixes());
							}
							if(pdfCombinerArguments.isExportToXls()) {
								reporter = new ExcelReporter(fileName,
										disclaimerXmlFilename,
										mapPanelOrderPrefXmlFilename,
										pdfCombinerArguments.isExcludeNetworkDetails(),
										pdfCombinerArguments.isShowTotalProgramSummary(),
										pdfCombinerArguments.isShowIndividualMarketSummary(),
										pdfCombinerArguments.isShowIndividualFlightSummary(),
										file);
							}
							System.out.println("Reporter" + reporter);
							
							if(pdfCombinerArguments.isExportToXls()) {

				    			// upload to salesforce
						    	String result = uploadFileToSalesforce(reporter.getGeneratedReport("xlsx"), "xlsx", pdfCombinerArguments, sessionId);
								System.out.println("  ************* result uploadFileToSalesforce: " + result);

						    
						    	// get the id
						    	ObjectMapper mapper = new ObjectMapper(); // can reuse, share globally
						    	Map<String, String> resultJson = mapper.readValue(result, Map.class);
								System.out.println("  ************* resultJson : " + resultJson);
						    	String xlsDocumentId = resultJson.get("id");
								System.out.println("   contentId: " + xlsDocumentId);

								it.remove();
				    		} else {
				    			PdfReporter pdfReporter = (PdfReporter) reporter;
								file.setFileName(reporter.getGeneratedReport("pdf"));

								// set custom toc frm report to combiner arguments
								pdfCombinerArguments.setPdfCombinerContentEntryList(pdfReporter.getPDFCombinerContentEntryList());
							}
						} else {
							file.setFileName(fileName);
						}
					} catch(Exception e) {
						System.out.println(" Exception generating output " + e.getMessage());
					}
				}
			}
			// if it has appendixes
			if(pdfCombinerArguments.isExportToPdf() && pdfCombinerArguments.getAppendixes() != null) {
				List<PDFCombinerFile> appendixes = new ArrayList<PDFCombinerFile>();
				for(PDFCombinerFile file : pdfCombinerArguments.getAppendixes()) {
					String fileName = "c:/tmp/" + file.getPathOnClient();
					if(downloadFile(file.getSalesforceUrl(), sessionId, fileName)){
						appendixes.add(file);
					}
					file.setFileName(fileName);
				}
				System.out.println("   appendix list size" + pdfCombinerArguments.getAppendixes().size());
				System.out.println("   resultant appendix list size" + appendixes.size());
				pdfCombinerArguments.setAppendixes(appendixes);			    	
			}
			// TODO: it will be necessary to export pdf and xls at the same time
			if(pdfCombinerArguments.isExportToPdf()) {
				// instantiate pdfcombiner and get pdf filename (ephimeral filesystem path)
				System.out.println("   combining content");
				PDFCombiner combiner = new PDFCombiner();
				String pdfFile = combiner.combine(pdfCombinerArguments);

				// upload pdf to storage service (to avoid ephimeral file being removed)
				// TODO: disabled because it is giving error number 500
				String result = uploadFileToSalesforce(pdfFile, "pdf", pdfCombinerArguments, sessionId);
				System.out.println("  ************* result uploadFileToSalesforce: " + result);


				// get the id
				ObjectMapper mapper = new ObjectMapper(); // can reuse, share globally
				Map<String, String> resultJson = mapper.readValue(result, Map.class);
				System.out.println("  ************* resultJson : " + resultJson);
				String pdfDocumentId = resultJson.get("id");
				System.out.println("   contentId: " + pdfDocumentId);
			}
		} catch (Exception ex) {
			System.out.println("   exception in worker" + ex);
			ex.printStackTrace();
		}
	}

	public static String uploadFileToSalesforce(String sourceFileName,
			String fileExtension, PDFCombinerArguments pdfCombinerArguments, String sessionId)
					throws MalformedURLException, IOException {

		System.out.println("uploadFileToSalesforce(): begin");

		FileUploader fileUpload = new FileUploader();
		File file = new File(sourceFileName);

		String resultingFileName = StringEscapeUtils.escapeJava(pdfCombinerArguments.getOutputFileName()) + "." + fileExtension;

		HashMap<String, String> headerHashMap = new HashMap<String, String>();
		headerHashMap.put("Authorization", "Bearer " + sessionId);
		headerHashMap.put("Accept", "application/json");

		//creeate jsonContent
		String jsonContent = 
				"{" + 
						"	\"Title\" : \"" + StringEscapeUtils.escapeJava(pdfCombinerArguments.getTitle()) + "\"," +
						"	\"Description\" : \"" + StringEscapeUtils.escapeJava(pdfCombinerArguments.getSubTitle()) + "\"," +
						"	\"FirstPublishLocationId\" : \"" + pdfCombinerArguments.getContentDocumentId() + "\"," +
						"	\"ReasonForChange\" : \"" + StringEscapeUtils.escapeJava(pdfCombinerArguments.getTitle()) + "\"," +
						"	\"PathOnClient\" : \"" + resultingFileName + "\"" +
						"}";

		System.out.println("uploadFileToSalesforce(): jsonContent " + jsonContent);			
		String response = fileUpload.executeMultiPartRequest(
				pdfCombinerArguments.getInsertContentVersionUrl(),
				file,
				jsonContent,
				headerHashMap);

		System.out.println("  uploadFileToSalesforce response: " + response);

		return response;
	}

	private static boolean downloadFile(String url, String sessionId, String outputFileName) {
		System.out.println("downloadFile(): begin");
		System.out.println("   url           : " + url);
		System.out.println("   sessionId     : " + sessionId);
		System.out.println("   outputFileName: " + outputFileName);
		System.out.println("   curl command  : curl -H \"Authorization: Bearer " + sessionId + "\" -H \"Accept: application/xml\"" + url);
		boolean isSuccess = false;
		int size=1024;
		InputStream is = null;
		OutputStream outStream = null;
		URLConnection  uCon = null;
		try {
			URL Url;
			byte[] buf;
			int ByteRead,ByteWritten=0;
			Url= new URL(url);
			outStream = new BufferedOutputStream(new FileOutputStream(outputFileName));

			uCon = Url.openConnection();
			uCon.setRequestProperty("Authorization", "Bearer " + sessionId);
			uCon.setRequestProperty("Accept", "application/xml, application/pdf");
			is = uCon.getInputStream();
			buf = new byte[size];
			while ((ByteRead = is.read(buf)) != -1) {
				outStream.write(buf, 0, ByteRead);
				ByteWritten += ByteRead;
			}
			System.out.println("   Downloaded Successfully.");
			System.out.println("   File name:\""+outputFileName+ "\"\nNo ofbytes :" + ByteWritten);
			isSuccess = true;
		} catch (Exception e) {
			e.printStackTrace();
		} finally {
			try {
				is.close();
				outStream.close();
			}
			catch (Exception e) {
				e.printStackTrace();
			}
		}
		return isSuccess;
	}
}
